<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Encoders on MPLAB Device Blocks for Simulink</title><link>https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block/encoders/</link><description>Recent content in Encoders on MPLAB Device Blocks for Simulink</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Wed, 05 Nov 2025 23:26:03 +0100</lastBuildDate><atom:link href="https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block/encoders/index.xml" rel="self" type="application/rss+xml"/><item><title>CN - Change Notification (Pin Interrupt)</title><link>https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block/encoders/change_notification/</link><pubDate>Thu, 16 Oct 2025 00:00:00 +0000</pubDate><guid>https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block/encoders/change_notification/</guid><description>&lt;div class="block-icon-container"&gt;
 &lt;div class="block-icon-image"&gt;
 &lt;picture&gt;&lt;img src="https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/assets/images/blocks/digital/ChangeNotification.png" alt="Change Notification Block Icon"&gt;
 &lt;/picture&gt;
 &lt;/div&gt;

 &lt;div class="block-icon-description"&gt;
 Change Notification - Pin State Change Interrupts and Timing
 &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id="overview"&gt;Overview&lt;/h2&gt;
&lt;p&gt;The MCHP_CN block provides an interface to the Change Notification (CN) peripheral, which detects pin state changes and measures transition timing. While primarily used for GPIO interrupts (buttons, switches), CN can also serve as a simple encoder interface or pulse counter.
&lt;strong&gt;Key Features:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Multi-pin state change detection (up to 32 CN pins)&lt;/li&gt;
&lt;li&gt;Edge detection: rising, falling, or both&lt;/li&gt;
&lt;li&gt;Transition timing measurement (time between edges)&lt;/li&gt;
&lt;li&gt;Period measurement (rising-to-rising or falling-to-falling)&lt;/li&gt;
&lt;li&gt;Programmable pull-up/pull-down resistors&lt;/li&gt;
&lt;li&gt;Interrupt generation on pin change&lt;/li&gt;
&lt;li&gt;Wake from sleep on pin change&lt;/li&gt;
&lt;li&gt;Can be used for simple rotary encoders or pulse counting&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="device-support"&gt;Device Support&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Family&lt;/th&gt;
 &lt;th&gt;CN Type&lt;/th&gt;
 &lt;th&gt;CN Pins&lt;/th&gt;
 &lt;th&gt;Notes&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;dsPIC30F&lt;/td&gt;
 &lt;td&gt;Type 0&lt;/td&gt;
 &lt;td&gt;CN0-CN15&lt;/td&gt;
 &lt;td&gt;Dedicated CN peripheral&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;dsPIC33F&lt;/td&gt;
 &lt;td&gt;Type 0&lt;/td&gt;
 &lt;td&gt;CN0-CN23&lt;/td&gt;
 &lt;td&gt;Dedicated CN peripheral&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;dsPIC33E&lt;/td&gt;
 &lt;td&gt;Type 1&lt;/td&gt;
 &lt;td&gt;All GPIO pins&lt;/td&gt;
 &lt;td&gt;All ports have CN capability&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;dsPIC33C&lt;/td&gt;
 &lt;td&gt;Type 1&lt;/td&gt;
 &lt;td&gt;All GPIO pins&lt;/td&gt;
 &lt;td&gt;All ports have CN capability&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;PIC32MK&lt;/td&gt;
 &lt;td&gt;Type 2&lt;/td&gt;
 &lt;td&gt;Port-based&lt;/td&gt;
 &lt;td&gt;One interrupt per port&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;PIC24F&lt;/td&gt;
 &lt;td&gt;Type 0/1&lt;/td&gt;
 &lt;td&gt;Varies&lt;/td&gt;
 &lt;td&gt;Family dependent&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="block-parameters"&gt;Block Parameters&lt;/h2&gt;
&lt;h3 id="channel-selection"&gt;Channel Selection&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Parameter&lt;/th&gt;
 &lt;th&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;CN Channels (dsPIC30F/33F)&lt;/td&gt;
 &lt;td&gt;Vector of CN channel numbers, e.g., [0 1 2] for CN0, CN1, CN2&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;CN Port (dsPIC33E/C, PIC32MK)&lt;/td&gt;
 &lt;td&gt;Port pin list, e.g., [A0 A1 B5] for PA0, PA1, PB5&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="measurement-configuration-per-channel"&gt;Measurement Configuration (per channel)&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Mode Value&lt;/th&gt;
 &lt;th&gt;Measurement&lt;/th&gt;
 &lt;th&gt;Output Ports&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;0&lt;/td&gt;
 &lt;td&gt;Change detect only&lt;/td&gt;
 &lt;td&gt;Change detected flag only&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;1&lt;/td&gt;
 &lt;td&gt;Measure time UP (rising edge to falling edge)&lt;/td&gt;
 &lt;td&gt;T_Up (pulse width high)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;2&lt;/td&gt;
 &lt;td&gt;Measure time DOWN (falling edge to rising edge)&lt;/td&gt;
 &lt;td&gt;T_Down (pulse width low)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;3&lt;/td&gt;
 &lt;td&gt;Measure UP &amp;amp; DOWN&lt;/td&gt;
 &lt;td&gt;T_Up, T_Down&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;4&lt;/td&gt;
 &lt;td&gt;Period on rising edge&lt;/td&gt;
 &lt;td&gt;P_Rising (time between rising edges)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;8&lt;/td&gt;
 &lt;td&gt;Period on falling edge&lt;/td&gt;
 &lt;td&gt;P_Falling (time between falling edges)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;5&lt;/td&gt;
 &lt;td&gt;UP + Period on rising&lt;/td&gt;
 &lt;td&gt;T_Up, P_Rising&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;10&lt;/td&gt;
 &lt;td&gt;DOWN + Period on falling&lt;/td&gt;
 &lt;td&gt;T_Down, P_Falling&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="change-detection-per-channel"&gt;Change Detection (per channel)&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Value&lt;/th&gt;
 &lt;th&gt;Detection Mode&lt;/th&gt;
 &lt;th&gt;Output&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;0&lt;/td&gt;
 &lt;td&gt;No change detection&lt;/td&gt;
 &lt;td&gt;-&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;1&lt;/td&gt;
 &lt;td&gt;Rising edge&lt;/td&gt;
 &lt;td&gt;CNx_Rise (timestamp)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;2&lt;/td&gt;
 &lt;td&gt;Falling edge&lt;/td&gt;
 &lt;td&gt;CNx_Fall (timestamp)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;3&lt;/td&gt;
 &lt;td&gt;Both edges&lt;/td&gt;
 &lt;td&gt;CNx_Rise&amp;amp;Fall (timestamp)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="advanced-configuration"&gt;Advanced Configuration&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Parameter&lt;/th&gt;
 &lt;th&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;Output Port Value&lt;/td&gt;
 &lt;td&gt;Enable current pin state output (boolean per channel)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Max Channel&lt;/td&gt;
 &lt;td&gt;Maximum expected time for measurements (seconds, per channel)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Safe Margin&lt;/td&gt;
 &lt;td&gt;Percentage margin for timer overflow protection (per channel)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Interrupt Priority&lt;/td&gt;
 &lt;td&gt;CN interrupt priority level (1-7)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="cn-peripheral-registers"&gt;CN Peripheral Registers&lt;/h2&gt;
&lt;h3 id="dspic30f33f-type-0"&gt;dsPIC30F/33F (Type 0)&lt;/h3&gt;
&lt;p&gt;// Enable CN module CNCONbits.ON = 1; // Enable specific CN pins CNEN1bits.CN0IE = 1; // Enable CN0 CNEN1bits.CN1IE = 1; // Enable CN1// Enable pull-ups CNPU1bits.CN0PUE = 1; // Pull-up on CN0// Interrupt configuration IFS1bits.CNIF = 0; // Clear interrupt flag IEC1bits.CNIE = 1; // Enable CN interrupt IPC4bits.CNIP = 5; // Priority level// Read current state state = PORTBbits.RB0; // Read pin state (if CN0 is on RB0)&lt;/p&gt;</description></item><item><title>PDEC - Position Decoder for SAM Devices</title><link>https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block/encoders/pdec/</link><pubDate>Thu, 16 Oct 2025 00:00:00 +0000</pubDate><guid>https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block/encoders/pdec/</guid><description>&lt;div class="block-icon-container"&gt;
 &lt;div class="block-icon-image"&gt;
 &lt;picture&gt;&lt;img src="https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/assets/images/blocks/digital/PDEC.png" alt="PDEC Block Icon"&gt;
 &lt;/picture&gt;
 &lt;/div&gt;

 &lt;div class="block-icon-description"&gt;
 Position Decoder - Hall Sensors and Stepper Motor Interface
 &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id="overview"&gt;Overview&lt;/h2&gt;
&lt;p&gt;The MCHP_PDEC block provides an interface to the Position Decoder (PDEC) peripheral on SAM E5x and E7x microcontrollers. Unlike traditional quadrature encoders, PDEC is optimized for Hall effect sensors (3-phase BLDC motors) and stepper motor position tracking, with specialized features for these applications.
&lt;strong&gt;Key Features:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;3-input position decoder (Hall sensors: A, B, C)&lt;/li&gt;
&lt;li&gt;Quadrature encoder mode (X2/X4)&lt;/li&gt;
&lt;li&gt;Counter with direction input mode&lt;/li&gt;
&lt;li&gt;Configurable position counter and revolution counter&lt;/li&gt;
&lt;li&gt;Auto-correction for phase errors&lt;/li&gt;
&lt;li&gt;Programmable digital filtering&lt;/li&gt;
&lt;li&gt;Index pulse support&lt;/li&gt;
&lt;li&gt;Angular position calculation (9-bit + configurable resolution)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="device-support"&gt;Device Support&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Family&lt;/th&gt;
 &lt;th&gt;PDEC Module&lt;/th&gt;
 &lt;th&gt;Features&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;SAM E54/E53/E51&lt;/td&gt;
 &lt;td&gt;1&lt;/td&gt;
 &lt;td&gt;Hall sensor, quadrature, stepper position&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;SAM E70/S70/V71&lt;/td&gt;
 &lt;td&gt;1&lt;/td&gt;
 &lt;td&gt;Hall sensor, quadrature, stepper position&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="block-parameters"&gt;Block Parameters&lt;/h2&gt;
&lt;h3 id="operating-mode"&gt;Operating Mode&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Parameter&lt;/th&gt;
 &lt;th&gt;Options&lt;/th&gt;
 &lt;th&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;Mode&lt;/td&gt;
 &lt;td&gt;• Quadrature Encoder&lt;/td&gt;
 &lt;td&gt;• Counter with direction&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="position-configuration"&gt;Position Configuration&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Parameter&lt;/th&gt;
 &lt;th&gt;Options&lt;/th&gt;
 &lt;th&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;Counter Output&lt;/td&gt;
 &lt;td&gt;on/off&lt;/td&gt;
 &lt;td&gt;Enable position counter output&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Counter Datatype&lt;/td&gt;
 &lt;td&gt;unsigned/signed&lt;/td&gt;
 &lt;td&gt;Position counter sign&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Revolution Output&lt;/td&gt;
 &lt;td&gt;on/off&lt;/td&gt;
 &lt;td&gt;Enable revolution counter&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Revolution Datatype&lt;/td&gt;
 &lt;td&gt;unsigned/signed&lt;/td&gt;
 &lt;td&gt;Revolution counter sign&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Counter Revolution Length&lt;/td&gt;
 &lt;td&gt;• Counter is 16-bit (9+7 bit resolution)&lt;/td&gt;
 &lt;td&gt;• Counter is 17-bit (9+8 bit resolution)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="index-and-reset"&gt;Index and Reset&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Parameter&lt;/th&gt;
 &lt;th&gt;Options&lt;/th&gt;
 &lt;th&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;Index&lt;/td&gt;
 &lt;td&gt;• Not used&lt;/td&gt;
 &lt;td&gt;• Reset counter&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Max Counter Reset&lt;/td&gt;
 &lt;td&gt;Integer value&lt;/td&gt;
 &lt;td&gt;Modulo limit for position counter&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Max Position Input&lt;/td&gt;
 &lt;td&gt;on/off&lt;/td&gt;
 &lt;td&gt;Enable dynamic modulo limit via block input&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Reset Input&lt;/td&gt;
 &lt;td&gt;on/off&lt;/td&gt;
 &lt;td&gt;Enable external reset input&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="signal-configuration"&gt;Signal Configuration&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Pin&lt;/th&gt;
 &lt;th&gt;Function (Quadrature)&lt;/th&gt;
 &lt;th&gt;Function (Hall Sensor)&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;QDI0&lt;/td&gt;
 &lt;td&gt;Phase A&lt;/td&gt;
 &lt;td&gt;Hall A&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;QDI1&lt;/td&gt;
 &lt;td&gt;Phase B&lt;/td&gt;
 &lt;td&gt;Hall B&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;QDI2&lt;/td&gt;
 &lt;td&gt;Index&lt;/td&gt;
 &lt;td&gt;Hall C&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Parameter&lt;/td&gt;
 &lt;td&gt;Options&lt;/td&gt;
 &lt;td&gt;Description&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Invert QDI0/1/2&lt;/td&gt;
 &lt;td&gt;on/off&lt;/td&gt;
 &lt;td&gt;Invert input polarity&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Swap Pin Phase A &amp;amp; B&lt;/td&gt;
 &lt;td&gt;on/off&lt;/td&gt;
 &lt;td&gt;Reverse direction (quadrature mode)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Auto Correction&lt;/td&gt;
 &lt;td&gt;on/off&lt;/td&gt;
 &lt;td&gt;Automatic phase error correction&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Digital Filter&lt;/td&gt;
 &lt;td&gt;disabled or time period&lt;/td&gt;
 &lt;td&gt;Input signal filtering&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="hall-sensor-operation"&gt;Hall Sensor Operation&lt;/h2&gt;
&lt;h3 id="3-phase-hall-sensor-interface"&gt;3-Phase Hall Sensor Interface&lt;/h3&gt;
&lt;p&gt;PDEC decodes 3-wire Hall sensor signals for BLDC motor position:
Hall Sensor States (6-step commutation): State | Hall A | Hall B | Hall C | Sector &amp;mdash;&amp;mdash;-|&amp;mdash;&amp;mdash;&amp;ndash;|&amp;mdash;&amp;mdash;&amp;ndash;|&amp;mdash;&amp;mdash;&amp;ndash;|&amp;mdash;&amp;mdash;&amp;ndash; 1 | 0 | 0 | 1 | 0-60° 2 | 0 | 1 | 1 | 60-120° 3 | 0 | 1 | 0 | 120-180° 4 | 1 | 1 | 0 | 180-240° 5 | 1 | 0 | 0 | 240-300° 6 | 1 | 0 | 1 | 300-360° Valid transitions: 1→2→3→4→5→6→1 (CW) 1→6→5→4→3→2→1 (CCW)&lt;/p&gt;</description></item><item><title>QDEC SAMx - Quadrature Decoder for SAM Devices</title><link>https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block/encoders/qdec_samx/</link><pubDate>Thu, 16 Oct 2025 00:00:00 +0000</pubDate><guid>https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block/encoders/qdec_samx/</guid><description>&lt;div class="block-icon-container"&gt;
 &lt;div class="block-icon-image"&gt;
 &lt;picture&gt;&lt;img src="https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/assets/images/blocks/digital/QDEC_SAMx.png" alt="QDEC SAMx Block Icon"&gt;
 &lt;/picture&gt;
 &lt;/div&gt;

 &lt;div class="block-icon-description"&gt;
 Quadrature Decoder Using TC Modules - SAM Device Encoder Interface
 &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id="overview"&gt;Overview&lt;/h2&gt;
&lt;p&gt;The MCHP_QDEC_SAMx block implements quadrature encoder decoding using the Timer/Counter (TC) modules on SAM microcontrollers (E5x, E7x, C2x). Unlike dedicated QEI peripherals, this implementation uses TC modules in quadrature mode to decode encoder signals for position and speed measurement.
&lt;strong&gt;Key Features:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Quadrature position decoding using TC modules&lt;/li&gt;
&lt;li&gt;32-bit position counter with revolution counter&lt;/li&gt;
&lt;li&gt;Index pulse support for position reset&lt;/li&gt;
&lt;li&gt;Direction detection&lt;/li&gt;
&lt;li&gt;Speed measurement using time base&lt;/li&gt;
&lt;li&gt;Phase error detection (quadrature integrity check)&lt;/li&gt;
&lt;li&gt;Missing pulse error detection&lt;/li&gt;
&lt;li&gt;Configurable digital filtering&lt;/li&gt;
&lt;li&gt;Rotation change flag&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="device-support"&gt;Device Support&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Family&lt;/th&gt;
 &lt;th&gt;TC Modules&lt;/th&gt;
 &lt;th&gt;Max QDEC Instances&lt;/th&gt;
 &lt;th&gt;Features&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;SAM E54/E53&lt;/td&gt;
 &lt;td&gt;TC0-TC7&lt;/td&gt;
 &lt;td&gt;2-4&lt;/td&gt;
 &lt;td&gt;Position, speed, index, error detection&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;SAM E70/S70/V71&lt;/td&gt;
 &lt;td&gt;TC0-TC11&lt;/td&gt;
 &lt;td&gt;4&lt;/td&gt;
 &lt;td&gt;Position, speed, index, error detection&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;SAM C21&lt;/td&gt;
 &lt;td&gt;TC0-TC7&lt;/td&gt;
 &lt;td&gt;2-4&lt;/td&gt;
 &lt;td&gt;Position, speed, index, error detection&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Important:&lt;/strong&gt; Each QDEC instance requires 3 TC channels (one complete TC module). For example, TC0 uses channels 0, 1, and 2 for phase A/B counting, index counting, and speed time base respectively.&lt;/p&gt;</description></item><item><title>QEI - Quadrature Encoder Interface</title><link>https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block/encoders/qei/</link><pubDate>Thu, 16 Oct 2025 00:00:00 +0000</pubDate><guid>https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block/encoders/qei/</guid><description>&lt;div class="block-icon-container"&gt;
 &lt;div class="block-icon-image"&gt;
 &lt;picture&gt;&lt;img src="https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/assets/images/blocks/digital/QEI.png" alt="QEI Block Icon"&gt;
 &lt;/picture&gt;
 &lt;/div&gt;

 &lt;div class="block-icon-description"&gt;
 Quadrature Encoder Interface - Position and Velocity Measurement
 &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id="overview"&gt;Overview&lt;/h2&gt;
&lt;p&gt;The MCHP_QEI block provides an interface to the Quadrature Encoder Interface (QEI) peripheral available on dsPIC and PIC32 microcontrollers. This peripheral decodes quadrature encoder signals to measure position, direction, and velocity of rotating shafts, making it ideal for motor control and precision positioning applications.
&lt;strong&gt;Key Features:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Quadrature decoding (X2 and X4 modes)&lt;/li&gt;
&lt;li&gt;16-bit or 32-bit position counter&lt;/li&gt;
&lt;li&gt;Index pulse detection and position reset&lt;/li&gt;
&lt;li&gt;Direction sensing&lt;/li&gt;
&lt;li&gt;Programmable digital filtering&lt;/li&gt;
&lt;li&gt;Velocity measurement (32-bit QEI only)&lt;/li&gt;
&lt;li&gt;Multiple operating modes: encoder, pulse counter, up/down counter&lt;/li&gt;
&lt;li&gt;Position modulo and reset options&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="device-support"&gt;Device Support&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Family&lt;/th&gt;
 &lt;th&gt;QEI Type&lt;/th&gt;
 &lt;th&gt;Max Modules&lt;/th&gt;
 &lt;th&gt;Features&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;dsPIC30F&lt;/td&gt;
 &lt;td&gt;16-bit&lt;/td&gt;
 &lt;td&gt;1-2&lt;/td&gt;
 &lt;td&gt;Basic quadrature decoding, index reset&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;dsPIC33F&lt;/td&gt;
 &lt;td&gt;16-bit&lt;/td&gt;
 &lt;td&gt;1-2&lt;/td&gt;
 &lt;td&gt;Basic quadrature decoding, index reset&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;dsPIC33E&lt;/td&gt;
 &lt;td&gt;32-bit&lt;/td&gt;
 &lt;td&gt;1-2&lt;/td&gt;
 &lt;td&gt;Extended position counter, velocity measurement&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;dsPIC33C&lt;/td&gt;
 &lt;td&gt;32-bit&lt;/td&gt;
 &lt;td&gt;1-2&lt;/td&gt;
 &lt;td&gt;Extended position counter, velocity measurement&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;dsPIC33A&lt;/td&gt;
 &lt;td&gt;32-bit&lt;/td&gt;
 &lt;td&gt;1-2&lt;/td&gt;
 &lt;td&gt;Enhanced position/velocity, advanced filtering&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;PIC32MK&lt;/td&gt;
 &lt;td&gt;32-bit&lt;/td&gt;
 &lt;td&gt;1-2&lt;/td&gt;
 &lt;td&gt;Extended features, modulo with index reset&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="block-parameters"&gt;Block Parameters&lt;/h2&gt;
&lt;h3 id="operating-mode"&gt;Operating Mode&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Parameter&lt;/th&gt;
 &lt;th&gt;Options&lt;/th&gt;
 &lt;th&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;QEI Mode&lt;/td&gt;
 &lt;td&gt;• Quadrature Encoder&lt;/td&gt;
 &lt;td&gt;• External Pulse Counter&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;X2/X4 Mode&lt;/td&gt;
 &lt;td&gt;on/off (16-bit QEI only)&lt;/td&gt;
 &lt;td&gt;X2: 2 counts/line, X4: 4 counts/line&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="position-counter-configuration"&gt;Position Counter Configuration&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Parameter&lt;/th&gt;
 &lt;th&gt;Options&lt;/th&gt;
 &lt;th&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;Position Output&lt;/td&gt;
 &lt;td&gt;• is not an output&lt;/td&gt;
 &lt;td&gt;• 16-bit unsigned&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Position Reset Mode&lt;/td&gt;
 &lt;td&gt;• Never reset&lt;/td&gt;
 &lt;td&gt;• Reset on INDEX&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Modulo Limits&lt;/td&gt;
 &lt;td&gt;[Low High] vector&lt;/td&gt;
 &lt;td&gt;Position counter modulo boundaries&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Initial Value&lt;/td&gt;
 &lt;td&gt;Integer&lt;/td&gt;
 &lt;td&gt;Position initialization value&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="index-pulse-configuration"&gt;Index Pulse Configuration&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Parameter&lt;/th&gt;
 &lt;th&gt;Options&lt;/th&gt;
 &lt;th&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;Index Counter Output&lt;/td&gt;
 &lt;td&gt;• is not an output&lt;/td&gt;
 &lt;td&gt;• 16-bit unsigned/signed&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Index Match Value&lt;/td&gt;
 &lt;td&gt;QEA/QEB state (00, 01, 10, 11)&lt;/td&gt;
 &lt;td&gt;Encoder state when index is valid&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Index Polarity&lt;/td&gt;
 &lt;td&gt;Active high/low&lt;/td&gt;
 &lt;td&gt;Index pulse polarity&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="velocity-measurement-32-bit-qei"&gt;Velocity Measurement (32-bit QEI)&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Parameter&lt;/th&gt;
 &lt;th&gt;Options&lt;/th&gt;
 &lt;th&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;Velocity Output&lt;/td&gt;
 &lt;td&gt;• is not an output&lt;/td&gt;
 &lt;td&gt;• 16-bit unsigned&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Period Output&lt;/td&gt;
 &lt;td&gt;• is not an output&lt;/td&gt;
 &lt;td&gt;• 16-bit unsigned&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Max Period&lt;/td&gt;
 &lt;td&gt;Time (seconds)&lt;/td&gt;
 &lt;td&gt;Maximum period for velocity calculation&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="signal-conditioning"&gt;Signal Conditioning&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Parameter&lt;/th&gt;
 &lt;th&gt;Options&lt;/th&gt;
 &lt;th&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;Digital Filter&lt;/td&gt;
 &lt;td&gt;on/off&lt;/td&gt;
 &lt;td&gt;Enable input signal filtering&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Filter Cutoff Freq&lt;/td&gt;
 &lt;td&gt;Frequency (Hz)&lt;/td&gt;
 &lt;td&gt;Low-pass filter cutoff frequency&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Swap QEA/QEB&lt;/td&gt;
 &lt;td&gt;on/off&lt;/td&gt;
 &lt;td&gt;Reverse encoder direction&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Invert Polarity&lt;/td&gt;
 &lt;td&gt;QEA, QEB, INDEX, HOME&lt;/td&gt;
 &lt;td&gt;Invert input signal polarity&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="pin-configuration-remappable-devices"&gt;Pin Configuration (Remappable Devices)&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Pin&lt;/th&gt;
 &lt;th&gt;Function&lt;/th&gt;
 &lt;th&gt;Description&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;QEA/QEIA&lt;/td&gt;
 &lt;td&gt;Phase A Input&lt;/td&gt;
 &lt;td&gt;Encoder channel A (or pulse input)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;QEB/QEIB&lt;/td&gt;
 &lt;td&gt;Phase B Input&lt;/td&gt;
 &lt;td&gt;Encoder channel B (or direction input)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;INDEX/QEINDX&lt;/td&gt;
 &lt;td&gt;Index Input&lt;/td&gt;
 &lt;td&gt;Index pulse for position reset&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;HOME/QEIHOM&lt;/td&gt;
 &lt;td&gt;Home Input&lt;/td&gt;
 &lt;td&gt;Home reference signal (optional)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="quadrature-encoding-principles"&gt;Quadrature Encoding Principles&lt;/h2&gt;
&lt;h3 id="x4-quadrature-decoding"&gt;X4 Quadrature Decoding&lt;/h3&gt;
&lt;p&gt;In X4 mode, the QEI peripheral counts on both rising and falling edges of both channels, providing 4 counts per encoder line:
QEA &lt;em&gt;&lt;strong&gt;┌───┐&lt;/strong&gt;&lt;/em&gt;┌───┐&lt;em&gt;&lt;strong&gt;┌───┐&lt;/strong&gt;&lt;/em&gt;┌───┐___ │ │ │ │ │ │ │ │ └───┘ └───┘ └───┘ └───┘ QEB &lt;em&gt;&lt;strong&gt;&lt;em&gt;&lt;strong&gt;┌───┐&lt;/strong&gt;&lt;/em&gt;┌───┐&lt;/strong&gt;&lt;/em&gt;┌───┐___┌─── │ │ │ │ │ │ │ ____└───┘ └───┘ └───┘ └─── Count: 0 1 2 3 4 5 6 7 8 9 10 11 12 Direction: FORWARD (QEA leads QEB by 90°)&lt;/p&gt;</description></item></channel></rss>