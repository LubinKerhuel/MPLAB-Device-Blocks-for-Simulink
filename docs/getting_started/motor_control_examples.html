<!doctype html><html lang=en><head><title>Motor Control Examples - MPLAB Device Blocks for Simulink - MPLAB Device Blocks for Simulink</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="MPLAB Device Blocks for Simulink - Embedded Code Generation for dsPIC, PIC32, and SAM Microcontrollers"><meta name=keywords content="Microchip,MPLAB,MATLAB,Simulink,dsPIC,PIC32,Embedded,Code Generation,Motor Control"><meta name=author content="Microchip Technology Inc."><meta name=robots content="index, follow"><meta http-equiv=X-UA-Compatible content="IE=edge"><link rel=canonical href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/motor_control_examples.html><link rel=icon type=image/x-icon href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/favicon.ico><style>html,html[data-theme=dark],body{color-scheme:light only!important;background-color:#fff!important;color:#222!important}:root{--bg-primary:#f8f9fa;--bg-secondary:white;--bg-tertiary:#f8f9fa;--text-primary:#2c3e50;--text-secondary:#666;--text-tertiary:#6c757d;--text-heading:#1a1a1a;--border-color:#dee2e6;--border-light:#e1e8ed;--border-medium:#e9ecef;--accent-primary:#1C355E;--accent-secondary:#41B6E6;--accent-hover:#2a5a8f;--accent-light:#D1DDE6;--code-bg:#f4f4f4;--code-text:#c7254e;--pre-bg:linear-gradient(to bottom, #e8e8e8 0%, #f0f0f0 100%);--pre-border:#d0d0d0;--table-hover:#E5F3FF;--table-stripe:#f8f9fa;--note-bg:linear-gradient(to right, #e7f3fe 0%, #f5fbff 100%);--note-border:#2196F3;--note-text:#1976D2;--warning-bg:linear-gradient(to right, #fff9e6 0%, #fffcf0 100%);--warning-border:#ff9800;--warning-text:#f57c00;--shadow-sm:0 2px 4px rgba(0,0,0,0.05);--shadow-md:0 2px 8px rgba(0,0,0,0.08);--shadow-lg:0 2px 12px rgba(0,0,0,0.08)}[data-theme=dark]{--bg-primary:#1a1d23;--bg-secondary:#242831;--bg-tertiary:#2d3139;--text-primary:#e4e6eb;--text-secondary:#adb5bd;--text-tertiary:#8b95a1;--text-heading:#e4e6eb;--border-color:#3a3f4b;--border-light:#3a3f4b;--border-medium:#404654;--accent-primary:#41B6E6;--accent-secondary:#5AC8FA;--accent-hover:#6DD5FF;--accent-light:#1a2d3f;--code-bg:#2d3139;--code-text:#ff6b9d;--pre-bg:linear-gradient(to bottom, #2d3139 0%, #2d3139 100%);--pre-border:#3a3f4b;--table-hover:#1e3a52;--table-stripe:#2d3139;--note-bg:linear-gradient(to right, #1e3a52 0%, #1e3a52 100%);--note-border:#4da6d6;--note-text:#66b3e0;--warning-bg:linear-gradient(to right, #3d3520 0%, #3d3520 100%);--warning-border:#ffb347;--warning-text:#ffc870;--shadow-sm:0 2px 4px rgba(0,0,0,0.3);--shadow-md:0 2px 8px rgba(0,0,0,0.4);--shadow-lg:0 2px 12px rgba(0,0,0,0.5)}:root{--content-max-width:1000px;--content-margin-horizontal:30px;--content-margin-vertical:15px;--container-border-radius:8px}*{transition:background-color .3s ease,color .3s ease,border-color .3s ease}body{font-family:-apple-system,BlinkMacSystemFont,segoe ui,roboto,oxygen,ubuntu,cantarell,sans-serif;margin:0;padding:0;line-height:1.6;color:var(--text-primary);background-color:var(--bg-primary);font-size:15px}.doc-wrapper{display:flex;max-width:1600px;margin:0 auto;min-height:100vh}.sidebar{width:280px;background-color:var(--bg-secondary);border-right:1px solid var(--border-color);position:sticky;top:0;height:100vh;overflow-y:auto;overflow-x:hidden;flex-shrink:0}.sidebar::-webkit-scrollbar{width:8px}.sidebar::-webkit-scrollbar-track{background:var(--bg-tertiary)}.sidebar::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:4px}.sidebar::-webkit-scrollbar-thumb:hover{background:var(--accent-primary)}.content-wrapper{flex:1;min-width:0;background-color:var(--bg-primary)}.container{max-width:var(--content-max-width);margin:var(--content-margin-vertical)var(--content-margin-horizontal);background-color:var(--bg-secondary);padding:30px;box-shadow:var(--shadow-lg);border-radius:var(--container-border-radius)}.sidebar-header{padding:20px;border-bottom:2px solid var(--border-light);background:linear-gradient(135deg,var(--accent-primary) 0%,var(--accent-secondary) 100%)}.sidebar-title{color:#fff;font-size:16px;font-weight:700;margin:0;text-align:center}.sidebar-nav{padding:15px 0}.nav-section{margin-bottom:8px}.nav-section-title{display:flex;align-items:center;justify-content:space-between;padding:10px 20px;color:var(--text-primary);font-weight:600;font-size:14px;cursor:pointer;border-left:3px solid transparent;transition:all .2s ease}.nav-section-title:hover{background-color:var(--bg-tertiary);border-left-color:var(--accent-primary);color:var(--accent-primary)}.nav-section-title .icon{font-size:16px;margin-right:8px}.nav-section-title .toggle-icon{font-size:12px;transition:transform .2s ease}.nav-section.expanded .toggle-icon{transform:rotate(90deg)}.nav-section-children{display:none;padding-left:15px}.nav-section.expanded>.nav-section-children{display:block}.nav-link{display:block;padding:8px 20px;padding-left:45px;color:var(--text-secondary);font-size:13px;text-decoration:none;border-left:3px solid transparent;transition:all .2s ease}.nav-link:hover{background-color:var(--bg-tertiary);color:var(--accent-primary);border-left-color:var(--accent-light)}.nav-link.active{background-color:var(--accent-light);color:var(--accent-primary);border-left-color:var(--accent-primary);font-weight:600}.nav-subsection{margin-bottom:4px}.nav-subsection-title{display:flex;align-items:center;justify-content:space-between;padding:8px 20px;padding-left:35px;color:var(--text-primary);font-weight:600;font-size:13px;cursor:pointer;border-left:3px solid transparent;transition:all .2s ease;background-color:var(--bg-tertiary)}.nav-subsection-title:hover{background-color:var(--bg-primary);border-left-color:var(--accent-secondary);color:var(--accent-secondary)}.nav-subsection-title .icon{font-size:14px;margin-right:6px}.nav-subsection-title .toggle-icon{font-size:10px;transition:transform .2s ease}.nav-subsection.expanded .toggle-icon{transform:rotate(90deg)}.nav-subsection .nav-section-children{display:none;padding-left:10px}.nav-subsection.expanded>.nav-section-children{display:block}.nav-block-link{display:block;padding:6px 20px;padding-left:55px;color:var(--text-secondary);font-size:12px;text-decoration:none;border-left:3px solid transparent;transition:all .2s ease}.nav-block-link:hover{background-color:var(--accent-light);color:var(--accent-primary);border-left-color:var(--accent-secondary)}.nav-block-link.active{background-color:var(--accent-light);color:var(--accent-primary);border-left-color:var(--accent-primary);font-weight:600}.mobile-nav-toggle{display:none;position:fixed;bottom:20px;right:20px;width:56px;height:56px;border-radius:50%;background:var(--accent-primary);color:#fff;border:none;font-size:24px;cursor:pointer;box-shadow:var(--shadow-lg);z-index:1000}.mobile-nav-toggle:hover{background:var(--accent-hover)}.theme-toggle{display:inline-flex;align-items:center;gap:6px;cursor:pointer;background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:20px;padding:6px 12px;font-size:13px;color:var(--text-secondary);margin-left:16px;user-select:none}.theme-toggle:hover{background:var(--accent-light);border-color:var(--accent-primary);color:var(--accent-primary)}.theme-icon{font-size:16px}.page-header{display:flex;justify-content:space-between;align-items:center;padding:16px 0 12px;margin-bottom:20px;border-bottom:3px solid var(--border-light);position:relative}.page-header::after{content:'';position:absolute;bottom:-3px;left:0;width:120px;height:3px;background:linear-gradient(90deg,var(--accent-primary),var(--accent-secondary))}.page-header h1{margin:0;color:var(--text-heading);font-size:32px;font-weight:700;letter-spacing:-.5px}.page-header-right{display:flex;align-items:center}.microchip-logo{height:40px;max-width:200px;object-fit:contain}.breadcrumbs{display:flex;align-items:center;font-size:13px;color:var(--text-secondary);margin-bottom:16px;padding:10px 14px;background:var(--bg-tertiary);border-radius:6px;border-left:3px solid var(--accent-primary)}.breadcrumbs a{color:var(--accent-primary);text-decoration:none;padding:4px 8px;border-radius:3px}.breadcrumbs a:hover{background-color:var(--accent-light);color:var(--accent-hover)}.breadcrumbs span{margin:0 8px;color:var(--text-tertiary)}h2{color:var(--text-heading);font-weight:600;font-size:22px;letter-spacing:-.5px;margin-top:32px;margin-bottom:12px;padding-bottom:6px;border-bottom:2px solid var(--border-light);position:relative}h2::before{content:'';position:absolute;bottom:-2px;left:0;width:60px;height:2px;background:linear-gradient(90deg,var(--accent-primary),var(--accent-secondary))}h3{color:var(--text-primary);font-weight:600;font-size:17px;margin-top:24px;margin-bottom:10px}h4{color:var(--text-primary);font-weight:500;font-size:15px;margin-top:18px;margin-bottom:8px}p{margin-bottom:12px;line-height:1.6;color:var(--text-primary)}table{border-collapse:separate;border-spacing:0;width:100%;margin:18px 0;border:1px solid var(--border-color);border-radius:6px;overflow:hidden;box-shadow:var(--shadow-md)}th{background:linear-gradient(to bottom,var(--accent-primary) 0%,var(--accent-secondary) 100%);color:#fff;padding:14px 16px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;letter-spacing:.5px;border-bottom:2px solid var(--accent-secondary)}td{padding:12px 16px;border-bottom:1px solid var(--border-medium);vertical-align:top;color:var(--text-primary);background-color:var(--bg-secondary)}tr:last-child td{border-bottom:none}tr:nth-child(even) td{background-color:var(--table-stripe)}tbody tr:hover td{background-color:var(--table-hover)}code{background-color:var(--code-bg);padding:3px 6px;border-radius:3px;font-family:consolas,monaco,courier new,monospace;color:var(--code-text);font-size:14px}pre{background:var(--pre-bg);border:1px solid var(--pre-border);border-left:4px solid var(--accent-primary);border-radius:6px;padding:16px;margin:18px 0;box-shadow:var(--shadow-sm);overflow-x:auto;line-height:1.5}pre code{background-color:initial;padding:0;color:var(--text-primary);font-family:consolas,monaco,courier new,monospace;font-size:14px}.note{background:var(--note-bg);border-left:5px solid var(--note-border);border-radius:4px;padding:14px 16px;margin:18px 0;box-shadow:var(--shadow-md);position:relative}.note::before{content:'\2139\FE0F  Note';display:block;font-weight:600;color:var(--note-text);margin-bottom:6px;font-size:14px}.note p{color:var(--text-primary)}.warning{background:var(--warning-bg);border-left:5px solid var(--warning-border);border-radius:4px;padding:14px 16px;margin:18px 0;box-shadow:var(--shadow-md);position:relative}.warning::before{content:'\26A0\FE0F  Warning';display:block;font-weight:600;color:var(--warning-text);margin-bottom:6px;font-size:14px}.warning p{color:var(--text-primary)}ul,ol{margin:12px 0;padding-left:30px;line-height:1.6}li{margin:6px 0;color:var(--text-primary)}li mjx-container[display=true]{text-align:left!important;margin:8px 0!important}li p mjx-container[display=true]{text-align:left!important;margin:8px 0!important}a{color:var(--accent-primary);text-decoration:none}a:hover{color:var(--accent-hover);text-decoration:underline}.nav-footer{margin-top:48px;padding:20px 0 12px;border-top:2px solid var(--border-light);font-size:11px;color:var(--text-tertiary);text-align:center}.nav-footer p{margin:0;font-size:11px}.block-icon-container{display:flex;align-items:center;gap:15px;margin:20px auto;padding:15px;max-width:900px;background-color:#f8f9fa;border-radius:8px;border:1px solid #dee2e6;transition:all .2s ease-in-out}.block-card-link{display:flex;align-items:center;gap:15px;flex:1;text-decoration:none;color:inherit}.block-icon-container:has(.block-card-link):hover{background-color:#e9ecef;border-color:#0076a8;box-shadow:0 2px 8px rgba(0,118,168,.15);cursor:pointer}.block-icon-image{flex-shrink:0;width:150px;display:flex;flex-direction:column;align-items:center;justify-content:flex-start}.block-icon-image picture{width:100%;max-width:150px;display:flex;align-items:center;justify-content:center}.block-icon-image img,.block-icon-image source{max-width:100%;max-height:100%;width:auto;height:auto;display:block;object-fit:contain}.block-icon-description{flex:1;font-size:16px;line-height:1.6;color:#333;column-count:1;max-width:100%}.family-tags{display:flex;flex-wrap:wrap;gap:6px;margin-top:12px;justify-content:center;width:100%}.family-tag{display:inline-block;padding:3px 8px;font-size:11px;font-weight:600;background-color:#2196f3;color:#fff;border-radius:4px;white-space:nowrap}.family-detail{font-weight:400;opacity:.9;font-size:10px;margin-left:3px}.chip-family-badges{display:flex;flex-direction:column;gap:6px;padding:12px;background-color:#e3f2fd;border:2px solid #2196f3;border-radius:6px;min-width:140px;flex-shrink:0}.chip-family-badges::before{content:"Device Support";font-size:11px;font-weight:700;color:#1565c0;text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px;text-align:center}.chip-badge{display:block;padding:6px 10px;font-size:12px;font-weight:600;border-radius:4px;white-space:nowrap;text-align:center;transition:all .15s ease-in-out}.chip-badge:hover{transform:scale(1.05);box-shadow:0 2px 4px rgba(0,0,0,.2)}.chip-badge.dspic30f{background-color:#e3f2fd;color:#1565c0;border:1px solid #90caf9}.chip-badge.dspic33f{background-color:#e8f5e9;color:#2e7d32;border:1px solid #81c784}.chip-badge.dspic33e{background-color:#fff3e0;color:#e65100;border:1px solid #ffb74d}.chip-badge.dspic33c{background-color:#f3e5f5;color:#6a1b9a;border:1px solid #ba68c8}.chip-badge.dspic33a{background-color:#fce4ec;color:#c2185b;border:1px solid #f06292}.chip-badge.pic32{background-color:#e0f7fa;color:#00695c;border:1px solid #4db6ac}.chip-badge.sam{background-color:#fff9c4;color:#f57f17;border:1px solid #fdd835}.chip-badge.all-families{background-color:#e0e0e0;color:#424242;border:1px solid #9e9e9e;font-weight:700}p img,.container>img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-light);border-radius:4px;box-shadow:var(--shadow-sm)}@media(max-width:768px){body{padding:10px 20px}.container{padding:20px}.page-header{flex-direction:column;align-items:flex-start;gap:16px}.microchip-logo{height:40px}.page-header h1{font-size:24px}h2{font-size:20px}h3{font-size:16px}}@media(max-width:1024px){.sidebar{position:fixed;left:-280px;top:0;height:100vh;z-index:999;transition:left .3s ease;box-shadow:2px 0 8px rgba(0,0,0,.15)}.sidebar.mobile-visible{left:0}.mobile-nav-toggle{display:flex;align-items:center;justify-content:center}.content-wrapper{width:100%}.container{margin:10px 15px;padding:20px}.sidebar.mobile-visible::after{content:'';position:fixed;top:0;left:280px;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:-1}}@media(max-width:768px){.container{margin:10px;padding:15px}.page-header h1{font-size:22px}.breadcrumbs{font-size:12px;padding:8px 12px}.nav-section-title{font-size:13px;padding:8px 15px}.nav-link{font-size:12px;padding:6px 15px;padding-left:35px}}.under-construction-banner{background:linear-gradient(135deg,#ff9800 0%,#f57c00 100%);color:#fff;padding:12px 20px;text-align:center;font-size:14px;font-weight:600;border-bottom:3px solid #e65100;box-shadow:0 2px 8px rgba(0,0,0,.15);margin-bottom:20px}.under-construction-banner .icon{font-size:18px;margin-right:8px}.under-construction-banner strong{color:#fff;text-transform:uppercase;letter-spacing:.5px}</style><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","name":"Motor Control Examples - MPLAB Device Blocks for Simulink","description":"MPLAB Device Blocks for Simulink - Embedded Code Generation for dsPIC, PIC32, and SAM Microcontrollers","url":"https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink\/getting_started\/motor_control_examples.html","author":{"@type":"Organization","name":"Microchip Technology Inc."},"datePublished":"2025-10-16","dateModified":"2025-11-05","inLanguage":"en-US"}</script></head><body><div class=doc-wrapper><nav class=sidebar><div class=sidebar-header><h2 class=sidebar-title>MPLAB Blockset</h2></div><div class=sidebar-nav><div class=nav-section><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/index.html class=nav-section-title style="display:block;border-left:3px solid transparent"><span><span class=icon>üè†</span>Home</span></a></div><div class=nav-section id=section-getting-started><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/index.html class=nav-section-title onclick='return event.stopPropagation(),toggleSection("getting-started"),!0'><span><span class=icon>üöÄ</span>Getting Started</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("getting-started"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/overview.html class=nav-link>Overview</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/installation.html class=nav-link>Installation</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/quick_start.html class=nav-link>Quick Start Guide</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/board_templates.html class=nav-link>Board Templates</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/motor_control_examples.html class=nav-link>Motor Control Examples</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/scheduler_multitasking.html class=nav-link>Scheduler & Multitasking</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/external_mode_pil.html class=nav-link>External Mode & PIL</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/data_visualization.html class=nav-link>Data Visualization</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/supported_devices.html class=nav-link>Supported Devices</a></div></div><div class=nav-section id=section-user-guide><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/user_guide/index.html class=nav-section-title onclick='return event.stopPropagation(),toggleSection("user-guide"),!0'><span><span class=icon>üìö</span>User Guide</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("user-guide"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/user_guide/code_generation.html class=nav-link>Code Generation</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/user_guide/compiler_setup.html class=nav-link>Compiler Setup</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/user_guide/external_mode.html class=nav-link>External Mode</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/user_guide/pil_testing.html class=nav-link>PIL Testing</a></div></div><div class=nav-section id=section-block-reference><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/index.html class=nav-section-title onclick='return event.stopPropagation(),toggleSection("block-reference"),!0'><span><span class=icon>üß©</span>Block Reference</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("block-reference"),!1'>‚ñ∂</span></a><div class=nav-section-children><div class=nav-subsection id=section-pwm><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("pwm"),!0'><span><span class=icon>‚ö°</span>PWM</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("pwm"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/pwm.html class=nav-block-link>PWM</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/pwm_highspeed.html class=nav-block-link>PWM High-Speed</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/pwm_hs_fep.html class=nav-block-link>PWM HS FEP</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/pwm_highspeed_override.html class=nav-block-link>PWM HS Override</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/mcpwm.html class=nav-block-link>MCPWM (PIC32)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/pwm_sam7x.html class=nav-block-link>PWM SAM7x</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/pwm_sam7x_override.html class=nav-block-link>PWM SAM7x Override</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/tcc_pwm.html class=nav-block-link>TCC PWM (SAM)</a></div></div><div class=nav-subsection id=section-timers><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/timers/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("timers"),!0'><span><span class=icon>‚è±Ô∏è</span>Timers</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("timers"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/timers/timer_config.html class=nav-block-link>Timer Config</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/timers/timer_pil_profiling.html class=nav-block-link>PIL Profiling Timer</a></div></div><div class=nav-subsection id=section-capture-compare><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/capture_compare/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("capture-compare"),!0'><span><span class=icon>üìè</span>Input Capture / Output Compare</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("capture-compare"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/capture_compare/input_capture.html class=nav-block-link>Input Capture</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/capture_compare/output_compare_hw.html class=nav-block-link>Output Compare (HW)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/capture_compare/output_compare_sw.html class=nav-block-link>Output Compare (SW)</a></div></div><div class=nav-subsection id=section-adc><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("adc"),!0'><span><span class=icon>üìä</span>ADC</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("adc"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/adc.html class=nav-block-link>ADC (dsPIC)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/adc_hs_12b.html class=nav-block-link>ADC HS 12-bit</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/adc_highspeed_sar.html class=nav-block-link>ADC High-Speed SAR</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/adc_highspeed_sar_dspic.html class=nav-block-link>ADC HS SAR (dsPIC)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/adc_same5x.html class=nav-block-link>ADC (SAM E5x)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/adc_samrh707x.html class=nav-block-link>ADC (SAMRH707x)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/afec_sam7x.html class=nav-block-link>AFEC (SAM7x)</a></div></div><div class=nav-subsection id=section-communication><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("communication"),!0'><span><span class=icon>üì°</span>Communication</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("communication"),!1'>‚ñ∂</span></a><div class=nav-section-children><div class=nav-subsection id=section-uart><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication.html#uart-blocks class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("uart"),!0'><span><span class=icon></span>UART</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("uart"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/uart/uart_config.html class=nav-block-link>UART Config</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/uart/uart_tx.html class=nav-block-link>UART Tx</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/uart/uart_rx.html class=nav-block-link>UART Rx</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/uart/uart_txmatlab.html class=nav-block-link>UART Tx MATLAB</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/uart/uart_break_and_autobaud.html class=nav-block-link>UART Break & Autobaud</a></div></div><div class=nav-subsection id=section-can><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication.html#can-blocks class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("can"),!0'><span><span class=icon></span>CAN</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("can"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/can/can_config.html class=nav-block-link>CAN Config</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/can/can_tx.html class=nav-block-link>CAN Tx</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/can/can_rx.html class=nav-block-link>CAN Rx</a></div></div><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/i2c.html class=nav-block-link>I2C Master/Slave</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/spi.html class=nav-block-link>SPI Master/Slave</a></div></div><div class=nav-subsection id=section-digital-io><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/digital_io/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("digital-io"),!0'><span><span class=icon>üîå</span>Digital I/O</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("digital-io"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/digital_io/digital_input.html class=nav-block-link>Digital Input</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/digital_io/digital_output.html class=nav-block-link>Digital Output</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/digital_io/digital_output_read.html class=nav-block-link>Digital Output Read</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/digital_io/digital_output_write.html class=nav-block-link>Digital Output Write</a></div></div><div class=nav-subsection id=section-encoders><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/encoders/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("encoders"),!0'><span><span class=icon>üîÑ</span>Encoders</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("encoders"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/encoders_counters/qei.html class=nav-block-link>QEI (Quadrature Encoder)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/encoders_counters/pdec.html class=nav-block-link>PDEC (SAM)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/encoders_counters/qdec_samx.html class=nav-block-link>QDEC (SAM)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/encoders_counters/change_notification.html class=nav-block-link>Change Notification</a></div></div><div class=nav-subsection id=section-analog-io><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/analog_io/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("analog-io"),!0'><span><span class=icon>üìâ</span>Analog I/O</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("analog-io"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/analog_io/dac_samx.html class=nav-block-link>DAC (SAM)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/analog_io/comparator_opamps_volt_ref/highspeed_analogcomparator.html class=nav-block-link>High-Speed Comparator</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/analog_io/comparator_opamps_volt_ref/highspeed_analogcomparator_wslope.html class=nav-block-link>Comparator w/ Slope</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/analog_io/comparator_opamps_volt_ref/op_amp.html class=nav-block-link>Op-Amp</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/analog_io/comparator_opamps_volt_ref/pga.html class=nav-block-link>PGA (Programmable Gain Amp)</a></div></div><div class=nav-subsection id=section-system-config><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("system-config"),!0'><span><span class=icon>‚öôÔ∏è</span>System Config</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("system-config"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/master.html class=nav-block-link>Master</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/interrupt.html class=nav-block-link>Interrupt</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/compiler_options.html class=nav-block-link>Compiler Options</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/scheduler_options.html class=nav-block-link>Scheduler Options</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/idle_task.html class=nav-block-link>Idle Task</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/mcu_load.html class=nav-block-link>MCU Load</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/mcu_overload.html class=nav-block-link>MCU Overload</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/tasks_state.html class=nav-block-link>Tasks State</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/secondary_core.html class=nav-block-link>Secondary Core</a></div></div><div class=nav-subsection id=section-utility><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/utility/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("utility"),!0'><span><span class=icon>üîß</span>Utility Blocks</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("utility"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/user_functions/c_function_call.html class=nav-block-link>C Function Call</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/utility/doc.html class=nav-block-link>Documentation Block</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/utility/msi.html class=nav-block-link>MSI (Model Sample Info)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/utility/port_info.html class=nav-block-link>Port Info</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/utility/timer_info.html class=nav-block-link>Timer Info</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/utility/simulink_reset_config.html class=nav-block-link>Simulink Reset Config</a></div></div></div></div><div class=nav-section id=section-examples><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/examples/index.html class=nav-section-title onclick='return event.stopPropagation(),toggleSection("examples"),!0'><span><span class=icon>üìñ</span>Examples</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("examples"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/examples/field_weakening.html class=nav-link>Field Weakening</a></div></div><div class=nav-section id=section-github><a href=https://github.com/microchip-technology/mplab-blocksetindex.html class=nav-section-title style="display:block;border-left:3px solid transparent"><span><span class=icon>üíª</span>GitHub</span></a></div></div></nav><div class=content-wrapper><div class=container><div class=breadcrumbs><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/index.html>Home</a>
<span>></span>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/index.html>Getting Started</a>
<span>></span>
<span>Motor Control Examples - MPLAB Device Blocks for Simulink</span></div><div class=page-header><h1>Motor Control Examples - MPLAB Device Blocks for Simulink</h1><div class=page-header-right><img src=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/images/microchip-logo.png alt="Microchip Logo" class=microchip-logo>
<button class=theme-toggle onclick=toggleTheme() aria-label="Toggle dark mode">
<span class=theme-icon id=theme-icon>‚òÄÔ∏è</span>
<span id=theme-text>Light</span></button></div></div><h3 id=-third-party-educational-content>‚ö†Ô∏è Third-Party Educational Content</h3><p><strong>The motor control examples and algorithms presented in this guide are provided by the ctrl-elec project, an educational initiative from INSA Lyon (France).</strong></p><p><strong>Attribution:</strong></p><ul><li><strong>Project:</strong> ctrl-elec - Real-time Control & Embedded Systems Education</li><li><strong>Institution:</strong> Institut National des Sciences Appliqu√©es de Lyon (INSA Lyon)</li><li><strong>Website:</strong>[https://www.ctrl-elec.fr/]</li><li><strong>GitHub Repository:</strong>[https://github.com/rdelpoux/ctrl-elec]</li><li><strong>RCP Platform:</strong>[http://rcp.ctrl-elec.fr/]</li></ul><p><strong>License:</strong> Educational use - Please refer to the ctrl-elec website for specific licensing terms.</p><p><em>This content is included in the MPLAB Device Blocks for Simulink documentation to demonstrate real-world motor control applications. Microchip Technology and the MPLAB Device Blocks toolbox are separate from the ctrl-elec project.</em></p><h2 id=introduction>Introduction</h2><p>This guide demonstrates how to use the MPLAB Device Blocks for Simulink toolbox for motor control applications, using examples and educational materials from the ctrl-elec project (INSA Lyon).</p><p>The examples showcase:</p><ul><li><strong>Field-Oriented Control (FOC)</strong> for Permanent Magnet Synchronous Motors (PMSM)</li><li><strong>Sensorless control</strong> using position and speed observers</li><li><strong>Field weakening</strong> for extended speed range operation</li><li><strong>Real-time parameter tuning</strong> using External Mode</li><li><strong>Hardware-in-the-loop testing</strong> with dsPIC33 and PIC32 devices</li></ul><div class=note style="background-color:#f0f8ff;border-left:4px solid #0076a8;padding:15px;margin:20px 0"><p>Prerequisites:</p><pre><code>        Understanding of motor control theory (vector control, Park/Clarke transforms)
        Familiarity with Simulink and Model-Based Design
        Microchip development hardware (e.g., MCLV-2, dsPICDEM MCLV)
</code></pre></div><h2 id=example-1-field-oriented-control-foc-for-pmsm>Example 1: Field-Oriented Control (FOC) for PMSM</h2><h3 id=overview>Overview</h3><p>Field-Oriented Control (FOC) provides precise control of PMSM torque and speed by independently controlling flux and torque-producing currents in the rotating reference frame (d-q frame).</p><h3 id=control-algorithm-components>Control Algorithm Components</h3><table><thead><tr><th>Component</th><th>Function</th><th>MPLAB Blocks Used</th></tr></thead><tbody><tr><td>Clarke Transform</td><td>Converts 3-phase currents (a,b,c) to stationary frame (Œ±,Œ≤)</td><td>Math blocks (Simulink standard)</td></tr><tr><td>Park Transform</td><td>Converts stationary frame (Œ±,Œ≤) to rotating frame (d,q)</td><td>Math blocks with rotor position input</td></tr><tr><td>PI Controllers</td><td>Regulate d-axis and q-axis currents independently</td><td>Discrete PID blocks with anti-windup</td></tr><tr><td>Inverse Park</td><td>Converts voltage commands (Vd, Vq) to stationary frame</td><td>Math blocks with angle input</td></tr><tr><td>Space Vector Modulation</td><td>Generates 3-phase PWM duty cycles</td><td>MCHP_PWM_HS or MCHP_PWM_HS_FEP</td></tr><tr><td>Current Sensing</td><td>Measures motor phase currents</td><td>MCHP_ADC with PWM-synchronized sampling</td></tr><tr><td>Position/Speed Estimation</td><td>Encoder or sensorless observer</td><td>MCHP_QEI (encoder) or observer algorithm</td></tr></tbody></table><h3 id=implementation-steps>Implementation Steps</h3><ul><li><p><strong>Hardware Configuration</strong></p></li><li><p>Configure PWM outputs using <code>MCHP_PWM_HS_FEP</code> block</p></li><li><p>Set PWM frequency (typically 10-20 kHz)</p></li><li><p>Enable complementary mode with dead-time insertion</p></li><li><p>Configure center-aligned PWM for reduced harmonics</p></li><li><p><strong>ADC Setup</strong></p></li><li><p>Use <code>MCHP_ADC</code> block for current sensing</p></li><li><p>Trigger ADC from PWM for synchronous sampling</p></li><li><p>Sample at PWM valley or peak for accurate measurements</p></li><li><p>Enable ADC interrupt for time-critical control loop</p></li><li><p><strong>Control Loop Structure</strong></p></li><li><p>Outer loop: Speed controller (lower rate, e.g., 1 kHz)</p></li><li><p>Inner loop: Current controller (higher rate, e.g., 10 kHz)</p></li><li><p>Use multi-rate model with appropriate task priorities</p></li><li><p><strong>Parameter Tuning</strong></p></li><li><p>Enable External Mode for real-time tuning</p></li><li><p>Use picgui for lightweight data visualization</p></li><li><p>Adjust PI gains using Ziegler-Nichols or model-based methods</p></li></ul><h3 id=key-peripheral-blocks>Key Peripheral Blocks</h3><table><thead><tr><th>Block Name</th><th>Configuration</th><th>Purpose in FOC</th></tr></thead><tbody><tr><td>MCHP_Master</td><td>Select target device, enable multi-tasking</td><td>System configuration and scheduler</td></tr><tr><td>MCHP_PWM_HS_FEP</td><td>3-phase complementary, center-aligned, 10 kHz</td><td>Drive motor inverter (6 IGBTs/MOSFETs)</td></tr><tr><td>MCHP_ADC</td><td>2 channels (phase currents), PWM-triggered</td><td>Measure Ia, Ib (Ic calculated)</td></tr><tr><td>MCHP_QEI</td><td>Quadrature encoder interface, 1024 PPR</td><td>Rotor position and speed feedback</td></tr><tr><td>MCHP_UART_Config</td><td>115200 baud, XCP protocol</td><td>External Mode communication</td></tr><tr><td>MCHP_Interrupt</td><td>Timer or ADC interrupt, highest priority</td><td>Trigger fast current control loop</td></tr></tbody></table><div class=warning style="background-color:#fff3cd;border-left:4px solid #ffc107;padding:15px;margin:20px 0"><p>Safety Considerations:</p><pre><code>        Implement overcurrent protection using ADC limits and emergency shutdown
        Add dead-time compensation to prevent shoot-through
        Test control algorithm in simulation before hardware deployment
        Use current limiting during startup and parameter tuning
        Monitor MCU load to prevent scheduler overruns
</code></pre></div><h2 id=example-2-sensorless-control-with-sliding-mode-observer>Example 2: Sensorless Control with Sliding Mode Observer</h2><h3 id=overview-1>Overview</h3><p>Sensorless control eliminates the need for mechanical position sensors by estimating rotor position and speed from electrical measurements (voltages and currents). This example uses a Sliding Mode Observer (SMO) for robust position estimation.</p><h3 id=observer-algorithm-components>Observer Algorithm Components</h3><table><thead><tr><th>Component</th><th>Function</th><th>Implementation Notes</th></tr></thead><tbody><tr><td>Current Observer</td><td>Estimates stator currents using motor model</td><td>Uses measured voltages and motor parameters (Rs, Ls)</td></tr><tr><td>Back-EMF Estimation</td><td>Extracts back-EMF from current error</td><td>Sliding mode function with adaptive gain</td></tr><tr><td>Position Calculation</td><td>Computes rotor angle from back-EMF (Œ±,Œ≤)</td><td>Arctangent function with phase compensation</td></tr><tr><td>Speed Estimation</td><td>Differentiates position or uses PLL</td><td>Low-pass filter to reduce noise</td></tr><tr><td>Startup Strategy</td><td>Open-loop alignment then transition to sensorless</td><td>Forced angle ramp until sufficient back-EMF</td></tr></tbody></table><h3 id=mplab-blocks-configuration>MPLAB Blocks Configuration</h3><table><thead><tr><th>Block Name</th><th>Configuration</th><th>Purpose in Sensorless Control</th></tr></thead><tbody><tr><td>MCHP_ADC</td><td>4 channels: Ia, Ib, Vdc, temperature</td><td>Measure currents and DC bus voltage</td></tr><tr><td>MCHP_PWM_HS_FEP</td><td>Same as FOC example</td><td>Motor drive PWM generation</td></tr><tr><td>Observer Subsystem</td><td>Fixed-point or floating-point math</td><td>Sliding mode observer implementation</td></tr><tr><td>MCHP_Interrupt</td><td>ADC interrupt at PWM frequency</td><td>Execute observer at high rate (10-20 kHz)</td></tr></tbody></table><h3 id=key-tuning-parameters>Key Tuning Parameters</h3><ul><li><strong>Observer Gain (k_smo):</strong> Trade-off between convergence speed and noise sensitivity</li><li><strong>Low-Pass Filter Cutoff:</strong> Filter back-EMF signals without excessive phase delay</li><li><strong>Transition Speed:</strong> Minimum speed for sensorless operation (typically 5-10% rated speed)</li><li><strong>Startup Ramp Rate:</strong> Balance between fast startup and smooth transition</li></ul><div class=note style="background-color:#f0f8ff;border-left:4px solid #0076a8;padding:15px;margin:20px 0"><p>Advantages of Sensorless Control:</p><pre><code>        Reduced hardware cost (no encoder)
        Higher reliability (no mechanical sensor to fail)
        Simplified wiring and installation
        Suitable for harsh environments
    
    Limitations:
    
        Poor performance at zero/low speed
        Requires accurate motor parameters
        Sensitive to parameter variations (temperature, saturation)
        More complex tuning process
</code></pre></div><h2 id=example-3-field-weakening-control>Example 3: Field Weakening Control</h2><h3 id=overview-2>Overview</h3><p>Field weakening extends the speed range of PMSM beyond the base speed by injecting negative d-axis current. This reduces the flux linkage, allowing higher speeds while maintaining voltage within DC bus limits.</p><h3 id=field-weakening-strategy>Field Weakening Strategy</h3><table><thead><tr><th>Operating Region</th><th>Control Strategy</th><th>Id Command</th><th>Iq Command</th></tr></thead><tbody><tr><td>Constant Torque (œâ &lt; œâbase)</td><td>Maximum torque per ampere (MTPA)</td><td>0 A (or slightly negative), Limited by max current</td><td></td></tr><tr><td>Field Weakening (œâbase &lt; œâ &lt; œâmax)</td><td>Voltage-limited operation</td><td>Negative (increases with speed)</td><td>Adjusted to maintain voltage limit</td></tr><tr><td>Constant Power (œâ ‚âà œâmax)</td><td>Maximum speed operation</td><td>Maximum negative Id</td><td>Reduced for voltage constraint</td></tr></tbody></table><h3 id=implementation-with-mplab-blocks>Implementation with MPLAB Blocks</h3><ul><li><p><strong>Voltage Limit Calculation</strong></p></li><li><p>Measure DC bus voltage using <code>MCHP_ADC</code></p></li><li><p>Calculate maximum voltage: Vmax = Vdc / ‚àö3 (for SVPWM)</p></li><li><p>Account for voltage drops and modulation overhead</p></li><li><p><strong>Field Weakening Controller</strong></p></li><li><p>Input: Speed feedback, voltage magnitude, current limits</p></li><li><p>Output: Id_ref (d-axis current command)</p></li><li><p>Algorithm: PI controller on voltage error or lookup table</p></li><li><p><strong>Current Limiting</strong></p></li><li><p>Enforce circular current limit: ‚àö(Id¬≤ + Iq¬≤) ‚â§ Imax</p></li><li><p>Priority given to Id (flux control) at high speeds</p></li><li><p>Reduce Iq if total current exceeds limit</p></li></ul><h3 id=tuning-guidelines>Tuning Guidelines</h3><table><thead><tr><th>Parameter</th><th>Typical Range</th><th>Effect</th></tr></thead><tbody><tr><td>Base Speed (œâbase)</td><td>Rated speed or design speed</td><td>Transition point to field weakening</td></tr><tr><td>Max Id Current</td><td>50-80% of rated current</td><td>Maximum field weakening capability</td></tr><tr><td>Voltage Margin</td><td>5-10% below Vmax</td><td>Safety buffer for control headroom</td></tr><tr><td>FW Controller Gain</td><td>Tuned for stability</td><td>Response speed vs. oscillations</td></tr></tbody></table><div class=warning style="background-color:#fff3cd;border-left:4px solid #ffc107;padding:15px;margin:20px 0"><p>Field Weakening Considerations:</p><pre><code>        Increased copper losses due to higher total current
        Reduced efficiency at high speeds
        Risk of demagnetization with excessive negative Id
        Requires precise voltage and current limiting
        Test carefully with thermal monitoring
</code></pre></div><h2 id=development-workflow-with-mplab-blocks>Development Workflow with MPLAB Blocks</h2><h3 id=step-1-model-development>Step 1: Model Development</h3><ul><li>Start from MCHP template for target device (e.g., dsPIC33CK Curiosity Board)</li><li>Add peripheral blocks: PWM, ADC, QEI, UART</li><li>Implement control algorithm using Simulink blocks</li><li>Configure multi-rate model: Fast loop (current) + Slow loop (speed)</li></ul><h3 id=step-2-simulation-and-validation>Step 2: Simulation and Validation</h3><ul><li>Test algorithm with motor model in Simulink</li><li>Verify control stability and transient response</li><li>Check for numerical issues (saturation, overflow)</li><li>Optimize fixed-point data types for embedded implementation</li></ul><h3 id=step-3-code-generation-and-deployment>Step 3: Code Generation and Deployment</h3><ul><li>Configure Embedded Coder settings in MCHP Master block</li><li>Generate C code and compile for target device</li><li>Program device using MPLAB X IPE or ICD</li><li>Use picgui or MPLAB Data Visualizer for initial debugging</li></ul><h3 id=step-4-real-time-tuning>Step 4: Real-Time Tuning</h3><ul><li>Enable External Mode in MCHP Master block</li><li>Connect via UART or USB to development PC</li><li>Adjust controller gains and parameters in real-time</li><li>Log data for post-processing and analysis</li></ul><h3 id=step-5-performance-optimization>Step 5: Performance Optimization</h3><ul><li>Run PIL (Processor-in-the-Loop) test for execution time analysis</li><li>Optimize code with dsPIC assembly replacements (if needed)</li><li>Monitor CPU load using MCHP_MCULoad block</li><li>Verify scheduler timing with MCHP_TasksState block</li></ul><h2 id=accessing-ctrl-elec-resources>Accessing ctrl-elec Resources</h2><h3 id=educational-materials>Educational Materials</h3><ul><li><p><strong>Website:</strong>[https://www.ctrl-elec.fr/]</p></li><li><p>Comprehensive tutorials on motor control theory</p></li><li><p>Detailed explanations of FOC, sensorless control, and field weakening</p></li><li><p>Step-by-step lab exercises with MATLAB/Simulink</p></li><li><p><strong>GitHub Repository:</strong>[https://github.com/rdelpoux/ctrl-elec]</p></li><li><p>Complete Simulink models for motor control examples</p></li><li><p>Reference implementations and test cases</p></li><li><p>Documentation and supplementary materials</p></li><li><p><strong>RCP Platform:</strong>[http://rcp.ctrl-elec.fr/]</p></li><li><p>Rapid Control Prototyping platform documentation</p></li><li><p>Hardware setup guides for various development boards</p></li><li><p>Application notes and best practices</p></li></ul><h3 id=adapting-ctrl-elec-examples-for-mplab-blocks>Adapting ctrl-elec Examples for MPLAB Blocks</h3><p>The ctrl-elec examples can be adapted to use MPLAB Device Blocks by:</p><ul><li><p><strong>Replace generic peripheral blocks</strong> with MCHP-specific blocks:</p></li><li><p>Generic PWM ‚Üí <code>MCHP_PWM_HS_FEP</code></p></li><li><p>Generic ADC ‚Üí <code>MCHP_ADC</code></p></li><li><p>Generic encoder ‚Üí <code>MCHP_QEI</code></p></li><li><p><strong>Configure MCHP Master block</strong> for target device and enable multi-tasking</p></li><li><p><strong>Adjust sample times</strong> to match MCHP scheduler rates</p></li><li><p><strong>Enable External Mode</strong> using MCHP UART blocks for real-time tuning</p></li><li><p><strong>Leverage MCHP-specific features</strong>:</p></li><li><p>PWM-triggered ADC for precise current sampling</p></li><li><p>DMA transfers for high-performance data movement</p></li><li><p>Assembly code replacement for optimized math operations</p></li></ul><hr><div class=note style="background-color:#f0f8ff;border-left:4px solid #0076a8;padding:15px;margin:20px 0">Integration Tip: The control algorithms (Clarke/Park transforms, PI controllers, observers) remain identical. Only the peripheral interface blocks need to be replaced with MPLAB-specific blocks. The ctrl-elec documentation provides excellent theoretical background that complements the MPLAB blocks hardware implementation.</div><h2 id=additional-resources>Additional Resources</h2><h3 id=mplab-blockset-documentation>MPLAB Blockset Documentation</h3><ul><li>[Scheduler and Multitasking] - Configure multi-rate control loops</li><li>[External Mode and PIL Testing] - Real-time tuning and verification</li><li>[PWM Block Reference] - Motor drive PWM configuration</li><li>[ADC Block Reference] - Current and voltage sensing setup</li><li>[QEI Block Reference] - Encoder interface for position feedback</li></ul><h3 id=microchip-application-notes>Microchip Application Notes</h3><ul><li>[AN1078] - Sensorless Field-Oriented Control (FOC) for PMSM</li><li>[AN1292] - Sensorless Field-Oriented Control of Three-Phase PMSMs</li><li>[AN1160] - Sensorless Field-Oriented Control of PMSM Motors</li><li>[AN2520] - Field Weakening for PMSM Motor Control</li></ul><h2 id=summary>Summary</h2><p>This guide demonstrated how to implement advanced motor control algorithms using the MPLAB Device Blocks for Simulink, leveraging educational resources from the ctrl-elec project (INSA Lyon).</p><p><strong>Key Takeaways:</strong></p><ul><li>MPLAB blocks provide hardware-optimized peripheral interfaces for motor control</li><li>Field-Oriented Control (FOC) can be implemented using standard Simulink blocks + MCHP PWM/ADC</li><li>Sensorless control eliminates encoders using observers, with trade-offs in low-speed performance</li><li>Field weakening extends speed range beyond base speed using negative d-axis current</li><li>External Mode and PIL testing enable efficient tuning and verification</li><li>Multi-rate scheduling optimizes CPU usage for nested control loops</li></ul><p><strong>Next Steps:</strong></p><ul><li>Visit [ctrl-elec website] for motor control theory tutorials</li><li>Download example models from [ctrl-elec GitHub]</li><li>Adapt examples using MCHP peripheral blocks for your target device</li><li>Use picgui and External Mode for real-time development</li><li>Refer to MPLAB blockset documentation for block-specific configuration details</li></ul><h3 id=attribution>Attribution</h3><p><strong>Motor control algorithms, theory, and examples presented in this guide are provided by:</strong></p><p><strong>ctrl-elec project</strong> - Real-time Control & Embedded Systems Education<strong>INSA Lyon</strong> (Institut National des Sciences Appliqu√©es de Lyon), France</p><p><strong>Website:</strong>[https://www.ctrl-elec.fr/]<strong>GitHub:</strong>[https://github.com/rdelpoux/ctrl-elec]<strong>RCP Platform:</strong>[http://rcp.ctrl-elec.fr/]</p><p><em>This documentation is part of the MPLAB Device Blocks for Simulink toolbox. The ctrl-elec project and INSA Lyon are independent educational initiatives. Microchip Technology provides the MPLAB blocks hardware interface, while ctrl-elec provides motor control algorithms and educational materials.</em></p><p><strong>MPLAB Device Blocks for Simulink</strong> ¬© Microchip Technology Inc. All rights reserved.</p><h2 id=see-also>See Also</h2><h3 id=application-notes>Application Notes</h3><ul><li><a href=https://www.microchip.com/AN1078>AN1078 - Sensorless Field-Oriented Control (FOC) for PMSM</a></li><li><a href=https://www.microchip.com/AN1292>AN1292 - Sensorless Field-Oriented Control of Three-Phase PMSMs</a></li><li><a href=https://www.microchip.com/AN1160>AN1160 - Sensorless Field-Oriented Control of PMSM Motors</a></li><li><a href=https://www.microchip.com/AN2520>AN2520</a></li></ul><h3 id=github>GitHub</h3><ul><li><a href=https://github.com/rdelpoux/ctrl-elec>https://github.com/rdelpoux/ctrl-elec</a></li><li><a href=https://github.com/rdelpoux/ctrl-elec>https://github.com/rdelpoux/ctrl-elec</a></li><li><a href=https://github.com/rdelpoux/ctrl-elec>ctrl-elec GitHub</a></li><li><a href=https://github.com/rdelpoux/ctrl-elec>https://github.com/rdelpoux/ctrl-elec</a></li></ul><h3 id=ctrl-elec>ctrl-elec</h3><ul><li><a href=https://www.ctrl-elec.fr/>https://www.ctrl-elec.fr/</a></li><li><a href=http://rcp.ctrl-elec.fr/>http://rcp.ctrl-elec.fr/</a></li><li><a href=https://www.ctrl-elec.fr/>https://www.ctrl-elec.fr/</a></li><li><a href=http://rcp.ctrl-elec.fr/>http://rcp.ctrl-elec.fr/</a></li><li><a href=https://www.ctrl-elec.fr/>ctrl-elec website</a></li><li><a href=https://www.ctrl-elec.fr/>https://www.ctrl-elec.fr/</a></li><li><a href=http://rcp.ctrl-elec.fr/>http://rcp.ctrl-elec.fr/</a></li></ul><div class=nav-footer><p>Last updated: November 2025 | MPLAB Blockset Documentation v3.63a</p><p>&copy; 2025 Microchip Technology Incorporated and its subsidiaries</p><p style=font-size:10px;margin-top:8px;line-height:1.4>The "Microchip" name and logo, the "M" logo, and other names, logos, and brands are registered
and unregistered trademarks of Microchip Technology Incorporated or its affiliates and/or
subsidiaries in the United States and/or other countries ("Microchip Trademarks"). Information
regarding Microchip Trademarks can be found at
<a href=https://www.microchip.com/en-us/about/legal-information/microchip-trademarks target=_blank style=color:var(--accent-primary)>https://www.microchip.com/en-us/about/legal-information/microchip-trademarks</a>.</p></div></div></div><button class=mobile-nav-toggle onclick=toggleMobileSidebar() aria-label="Toggle navigation">
‚ò∞</button></div><script>function toggleTheme(){const t=document.documentElement,n=t.getAttribute("data-theme"),e=n==="dark"?"light":"dark";t.setAttribute("data-theme",e),localStorage.setItem("theme",e),updateThemeButton(e)}function updateThemeButton(e){const t=document.getElementById("theme-icon"),n=document.getElementById("theme-text");e==="dark"?(t.textContent="üåô",n.textContent="Dark"):(t.textContent="‚òÄÔ∏è",n.textContent="Light")}(function(){const n=localStorage.getItem("theme"),s=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=n||(s?"dark":"light");document.documentElement.setAttribute("data-theme",t),updateThemeButton(t)})(),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{if(!localStorage.getItem("theme")){const t=e.matches?"dark":"light";document.documentElement.setAttribute("data-theme",t),updateThemeButton(t)}}),window.toggleSection=function(e){const t=document.getElementById("section-"+e);if(t&&(t.classList.toggle("expanded"),t.classList.contains("nav-section"))){const n=getExpandedSections();t.classList.contains("expanded")?n.add(e):n.delete(e),localStorage.setItem("expandedSections",JSON.stringify([...n]))}};function getExpandedSections(){const e=localStorage.getItem("expandedSections");return new Set(e?JSON.parse(e):[])}function restoreExpandedSections(){const e=getExpandedSections();e.forEach(e=>{const t=document.getElementById("section-"+e);t&&t.classList.add("expanded")})}function highlightActivePage(){const e=window.location.pathname,t=document.querySelectorAll(".nav-link, .nav-block-link, .nav-section-title[href], .nav-subsection-title[href]");t.forEach(t=>{const n=new URL(t.href,window.location.origin).pathname;if(n===e){t.classList.add("active");const n=t.closest(".nav-subsection");n&&!n.classList.contains("expanded")&&n.classList.add("expanded");const e=t.closest(".nav-section");if(e&&!e.classList.contains("expanded")){e.classList.add("expanded");const n=e.id.replace("section-",""),t=getExpandedSections();t.add(n),localStorage.setItem("expandedSections",JSON.stringify([...t]))}}})}window.toggleMobileSidebar=function(){const e=document.querySelector(".sidebar");e&&e.classList.toggle("mobile-visible")},function(){restoreExpandedSections(),highlightActivePage();const t=document.querySelector(".nav-link.active");if(t){const e=t.closest(".nav-section");if(e&&e.id){const n=e.id.replace("section-",""),t=getExpandedSections();t.has(n)||(t.add(n),localStorage.setItem("expandedSections",JSON.stringify([...t])))}}}()</script></body></html>