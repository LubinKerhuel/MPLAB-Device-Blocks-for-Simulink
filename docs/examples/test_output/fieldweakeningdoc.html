<!doctype html><html lang=en><head><title>Field-weakening - MPLAB Device Blocks for Simulink</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="MPLAB Device Blocks for Simulink - Embedded Code Generation for dsPIC, PIC32, and SAM Microcontrollers"><meta name=keywords content="Microchip,MPLAB,MATLAB,Simulink,dsPIC,PIC32,Embedded,Code Generation,Motor Control"><meta name=author content="Microchip Technology Inc."><meta name=robots content="index, follow"><meta http-equiv=X-UA-Compatible content="IE=edge"><link rel=canonical href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/examples/test_output/fieldweakeningdoc.html><link rel=icon type=image/x-icon href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/favicon.ico><style>html,html[data-theme=dark],body{color-scheme:light only!important;background-color:#fff!important;color:#222!important}:root{--bg-primary:#f8f9fa;--bg-secondary:white;--bg-tertiary:#f8f9fa;--text-primary:#2c3e50;--text-secondary:#666;--text-tertiary:#6c757d;--text-heading:#1a1a1a;--border-color:#dee2e6;--border-light:#e1e8ed;--border-medium:#e9ecef;--accent-primary:#1C355E;--accent-secondary:#41B6E6;--accent-hover:#2a5a8f;--accent-light:#D1DDE6;--code-bg:#f4f4f4;--code-text:#c7254e;--pre-bg:linear-gradient(to bottom, #e8e8e8 0%, #f0f0f0 100%);--pre-border:#d0d0d0;--table-hover:#E5F3FF;--table-stripe:#f8f9fa;--note-bg:linear-gradient(to right, #e7f3fe 0%, #f5fbff 100%);--note-border:#2196F3;--note-text:#1976D2;--warning-bg:linear-gradient(to right, #fff9e6 0%, #fffcf0 100%);--warning-border:#ff9800;--warning-text:#f57c00;--shadow-sm:0 2px 4px rgba(0,0,0,0.05);--shadow-md:0 2px 8px rgba(0,0,0,0.08);--shadow-lg:0 2px 12px rgba(0,0,0,0.08)}[data-theme=dark]{--bg-primary:#1a1d23;--bg-secondary:#242831;--bg-tertiary:#2d3139;--text-primary:#e4e6eb;--text-secondary:#adb5bd;--text-tertiary:#8b95a1;--text-heading:#e4e6eb;--border-color:#3a3f4b;--border-light:#3a3f4b;--border-medium:#404654;--accent-primary:#41B6E6;--accent-secondary:#5AC8FA;--accent-hover:#6DD5FF;--accent-light:#1a2d3f;--code-bg:#2d3139;--code-text:#ff6b9d;--pre-bg:linear-gradient(to bottom, #2d3139 0%, #2d3139 100%);--pre-border:#3a3f4b;--table-hover:#1e3a52;--table-stripe:#2d3139;--note-bg:linear-gradient(to right, #1e3a52 0%, #1e3a52 100%);--note-border:#4da6d6;--note-text:#66b3e0;--warning-bg:linear-gradient(to right, #3d3520 0%, #3d3520 100%);--warning-border:#ffb347;--warning-text:#ffc870;--shadow-sm:0 2px 4px rgba(0,0,0,0.3);--shadow-md:0 2px 8px rgba(0,0,0,0.4);--shadow-lg:0 2px 12px rgba(0,0,0,0.5)}:root{--content-max-width:1000px;--content-margin-horizontal:30px;--content-margin-vertical:15px;--container-border-radius:8px}*{transition:background-color .3s ease,color .3s ease,border-color .3s ease}body{font-family:-apple-system,BlinkMacSystemFont,segoe ui,roboto,oxygen,ubuntu,cantarell,sans-serif;margin:0;padding:0;line-height:1.6;color:var(--text-primary);background-color:var(--bg-primary);font-size:15px}.doc-wrapper{display:flex;max-width:1600px;margin:0 auto;min-height:100vh}.sidebar{width:280px;background-color:var(--bg-secondary);border-right:1px solid var(--border-color);position:sticky;top:0;height:100vh;overflow-y:auto;overflow-x:hidden;flex-shrink:0}.sidebar::-webkit-scrollbar{width:8px}.sidebar::-webkit-scrollbar-track{background:var(--bg-tertiary)}.sidebar::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:4px}.sidebar::-webkit-scrollbar-thumb:hover{background:var(--accent-primary)}.content-wrapper{flex:1;min-width:0;background-color:var(--bg-primary)}.container{max-width:var(--content-max-width);margin:var(--content-margin-vertical)var(--content-margin-horizontal);background-color:var(--bg-secondary);padding:30px;box-shadow:var(--shadow-lg);border-radius:var(--container-border-radius)}.sidebar-header{padding:20px;border-bottom:2px solid var(--border-light);background:linear-gradient(135deg,var(--accent-primary) 0%,var(--accent-secondary) 100%)}.sidebar-title{color:#fff;font-size:16px;font-weight:700;margin:0;text-align:center}.sidebar-nav{padding:15px 0}.nav-section{margin-bottom:8px}.nav-section-title{display:flex;align-items:center;justify-content:space-between;padding:10px 20px;color:var(--text-primary);font-weight:600;font-size:14px;cursor:pointer;border-left:3px solid transparent;transition:all .2s ease}.nav-section-title:hover{background-color:var(--bg-tertiary);border-left-color:var(--accent-primary);color:var(--accent-primary)}.nav-section-title .icon{font-size:16px;margin-right:8px}.nav-section-title .toggle-icon{font-size:12px;transition:transform .2s ease}.nav-section.expanded .toggle-icon{transform:rotate(90deg)}.nav-section-children{display:none;padding-left:15px}.nav-section.expanded>.nav-section-children{display:block}.nav-link{display:block;padding:8px 20px;padding-left:45px;color:var(--text-secondary);font-size:13px;text-decoration:none;border-left:3px solid transparent;transition:all .2s ease}.nav-link:hover{background-color:var(--bg-tertiary);color:var(--accent-primary);border-left-color:var(--accent-light)}.nav-link.active{background-color:var(--accent-light);color:var(--accent-primary);border-left-color:var(--accent-primary);font-weight:600}.nav-subsection{margin-bottom:4px}.nav-subsection-title{display:flex;align-items:center;justify-content:space-between;padding:8px 20px;padding-left:35px;color:var(--text-primary);font-weight:600;font-size:13px;cursor:pointer;border-left:3px solid transparent;transition:all .2s ease;background-color:var(--bg-tertiary)}.nav-subsection-title:hover{background-color:var(--bg-primary);border-left-color:var(--accent-secondary);color:var(--accent-secondary)}.nav-subsection-title .icon{font-size:14px;margin-right:6px}.nav-subsection-title .toggle-icon{font-size:10px;transition:transform .2s ease}.nav-subsection.expanded .toggle-icon{transform:rotate(90deg)}.nav-subsection .nav-section-children{display:none;padding-left:10px}.nav-subsection.expanded>.nav-section-children{display:block}.nav-block-link{display:block;padding:6px 20px;padding-left:55px;color:var(--text-secondary);font-size:12px;text-decoration:none;border-left:3px solid transparent;transition:all .2s ease}.nav-block-link:hover{background-color:var(--accent-light);color:var(--accent-primary);border-left-color:var(--accent-secondary)}.nav-block-link.active{background-color:var(--accent-light);color:var(--accent-primary);border-left-color:var(--accent-primary);font-weight:600}.mobile-nav-toggle{display:none;position:fixed;bottom:20px;right:20px;width:56px;height:56px;border-radius:50%;background:var(--accent-primary);color:#fff;border:none;font-size:24px;cursor:pointer;box-shadow:var(--shadow-lg);z-index:1000}.mobile-nav-toggle:hover{background:var(--accent-hover)}.theme-toggle{display:inline-flex;align-items:center;gap:6px;cursor:pointer;background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:20px;padding:6px 12px;font-size:13px;color:var(--text-secondary);margin-left:16px;user-select:none}.theme-toggle:hover{background:var(--accent-light);border-color:var(--accent-primary);color:var(--accent-primary)}.theme-icon{font-size:16px}.page-header{display:flex;justify-content:space-between;align-items:center;padding:16px 0 12px;margin-bottom:20px;border-bottom:3px solid var(--border-light);position:relative}.page-header::after{content:'';position:absolute;bottom:-3px;left:0;width:120px;height:3px;background:linear-gradient(90deg,var(--accent-primary),var(--accent-secondary))}.page-header h1{margin:0;color:var(--text-heading);font-size:32px;font-weight:700;letter-spacing:-.5px}.page-header-right{display:flex;align-items:center}.microchip-logo{height:40px;max-width:200px;object-fit:contain}.breadcrumbs{display:flex;align-items:center;font-size:13px;color:var(--text-secondary);margin-bottom:16px;padding:10px 14px;background:var(--bg-tertiary);border-radius:6px;border-left:3px solid var(--accent-primary)}.breadcrumbs a{color:var(--accent-primary);text-decoration:none;padding:4px 8px;border-radius:3px}.breadcrumbs a:hover{background-color:var(--accent-light);color:var(--accent-hover)}.breadcrumbs span{margin:0 8px;color:var(--text-tertiary)}h2{color:var(--text-heading);font-weight:600;font-size:22px;letter-spacing:-.5px;margin-top:32px;margin-bottom:12px;padding-bottom:6px;border-bottom:2px solid var(--border-light);position:relative}h2::before{content:'';position:absolute;bottom:-2px;left:0;width:60px;height:2px;background:linear-gradient(90deg,var(--accent-primary),var(--accent-secondary))}h3{color:var(--text-primary);font-weight:600;font-size:17px;margin-top:24px;margin-bottom:10px}h4{color:var(--text-primary);font-weight:500;font-size:15px;margin-top:18px;margin-bottom:8px}p{margin-bottom:12px;line-height:1.6;color:var(--text-primary)}table{border-collapse:separate;border-spacing:0;width:100%;margin:18px 0;border:1px solid var(--border-color);border-radius:6px;overflow:hidden;box-shadow:var(--shadow-md)}th{background:linear-gradient(to bottom,var(--accent-primary) 0%,var(--accent-secondary) 100%);color:#fff;padding:14px 16px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;letter-spacing:.5px;border-bottom:2px solid var(--accent-secondary)}td{padding:12px 16px;border-bottom:1px solid var(--border-medium);vertical-align:top;color:var(--text-primary);background-color:var(--bg-secondary)}tr:last-child td{border-bottom:none}tr:nth-child(even) td{background-color:var(--table-stripe)}tbody tr:hover td{background-color:var(--table-hover)}code{background-color:var(--code-bg);padding:3px 6px;border-radius:3px;font-family:consolas,monaco,courier new,monospace;color:var(--code-text);font-size:14px}pre{background:var(--pre-bg);border:1px solid var(--pre-border);border-left:4px solid var(--accent-primary);border-radius:6px;padding:16px;margin:18px 0;box-shadow:var(--shadow-sm);overflow-x:auto;line-height:1.5}pre code{background-color:initial;padding:0;color:var(--text-primary);font-family:consolas,monaco,courier new,monospace;font-size:14px}.note{background:var(--note-bg);border-left:5px solid var(--note-border);border-radius:4px;padding:14px 16px;margin:18px 0;box-shadow:var(--shadow-md);position:relative}.note::before{content:'\2139\FE0F  Note';display:block;font-weight:600;color:var(--note-text);margin-bottom:6px;font-size:14px}.note p{color:var(--text-primary)}.warning{background:var(--warning-bg);border-left:5px solid var(--warning-border);border-radius:4px;padding:14px 16px;margin:18px 0;box-shadow:var(--shadow-md);position:relative}.warning::before{content:'\26A0\FE0F  Warning';display:block;font-weight:600;color:var(--warning-text);margin-bottom:6px;font-size:14px}.warning p{color:var(--text-primary)}ul,ol{margin:12px 0;padding-left:30px;line-height:1.6}li{margin:6px 0;color:var(--text-primary)}li mjx-container[display=true]{text-align:left!important;margin:8px 0!important}li p mjx-container[display=true]{text-align:left!important;margin:8px 0!important}a{color:var(--accent-primary);text-decoration:none}a:hover{color:var(--accent-hover);text-decoration:underline}.nav-footer{margin-top:48px;padding:20px 0 12px;border-top:2px solid var(--border-light);font-size:11px;color:var(--text-tertiary);text-align:center}.nav-footer p{margin:0;font-size:11px}.block-icon-container{display:flex;align-items:center;gap:15px;margin:20px auto;padding:15px;max-width:900px;background-color:#f8f9fa;border-radius:8px;border:1px solid #dee2e6;transition:all .2s ease-in-out}.block-card-link{display:flex;align-items:center;gap:15px;flex:1;text-decoration:none;color:inherit}.block-icon-container:has(.block-card-link):hover{background-color:#e9ecef;border-color:#0076a8;box-shadow:0 2px 8px rgba(0,118,168,.15);cursor:pointer}.block-icon-image{flex-shrink:0;width:150px;display:flex;flex-direction:column;align-items:center;justify-content:flex-start}.block-icon-image picture{width:100%;max-width:150px;display:flex;align-items:center;justify-content:center}.block-icon-image img,.block-icon-image source{max-width:100%;max-height:100%;width:auto;height:auto;display:block;object-fit:contain}.block-icon-description{flex:1;font-size:16px;line-height:1.6;color:#333;column-count:1;max-width:100%}.family-tags{display:flex;flex-wrap:wrap;gap:6px;margin-top:12px;justify-content:center;width:100%}.family-tag{display:inline-block;padding:3px 8px;font-size:11px;font-weight:600;background-color:#2196f3;color:#fff;border-radius:4px;white-space:nowrap}.family-detail{font-weight:400;opacity:.9;font-size:10px;margin-left:3px}.chip-family-badges{display:flex;flex-direction:column;gap:6px;padding:12px;background-color:#e3f2fd;border:2px solid #2196f3;border-radius:6px;min-width:140px;flex-shrink:0}.chip-family-badges::before{content:"Device Support";font-size:11px;font-weight:700;color:#1565c0;text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px;text-align:center}.chip-badge{display:block;padding:6px 10px;font-size:12px;font-weight:600;border-radius:4px;white-space:nowrap;text-align:center;transition:all .15s ease-in-out}.chip-badge:hover{transform:scale(1.05);box-shadow:0 2px 4px rgba(0,0,0,.2)}.chip-badge.dspic30f{background-color:#e3f2fd;color:#1565c0;border:1px solid #90caf9}.chip-badge.dspic33f{background-color:#e8f5e9;color:#2e7d32;border:1px solid #81c784}.chip-badge.dspic33e{background-color:#fff3e0;color:#e65100;border:1px solid #ffb74d}.chip-badge.dspic33c{background-color:#f3e5f5;color:#6a1b9a;border:1px solid #ba68c8}.chip-badge.dspic33a{background-color:#fce4ec;color:#c2185b;border:1px solid #f06292}.chip-badge.pic32{background-color:#e0f7fa;color:#00695c;border:1px solid #4db6ac}.chip-badge.sam{background-color:#fff9c4;color:#f57f17;border:1px solid #fdd835}.chip-badge.all-families{background-color:#e0e0e0;color:#424242;border:1px solid #9e9e9e;font-weight:700}p img,.container>img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-light);border-radius:4px;box-shadow:var(--shadow-sm)}@media(max-width:768px){body{padding:10px 20px}.container{padding:20px}.page-header{flex-direction:column;align-items:flex-start;gap:16px}.microchip-logo{height:40px}.page-header h1{font-size:24px}h2{font-size:20px}h3{font-size:16px}}@media(max-width:1024px){.sidebar{position:fixed;left:-280px;top:0;height:100vh;z-index:999;transition:left .3s ease;box-shadow:2px 0 8px rgba(0,0,0,.15)}.sidebar.mobile-visible{left:0}.mobile-nav-toggle{display:flex;align-items:center;justify-content:center}.content-wrapper{width:100%}.container{margin:10px 15px;padding:20px}.sidebar.mobile-visible::after{content:'';position:fixed;top:0;left:280px;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:-1}}@media(max-width:768px){.container{margin:10px;padding:15px}.page-header h1{font-size:22px}.breadcrumbs{font-size:12px;padding:8px 12px}.nav-section-title{font-size:13px;padding:8px 15px}.nav-link{font-size:12px;padding:6px 15px;padding-left:35px}}.under-construction-banner{background:linear-gradient(135deg,#ff9800 0%,#f57c00 100%);color:#fff;padding:12px 20px;text-align:center;font-size:14px;font-weight:600;border-bottom:3px solid #e65100;box-shadow:0 2px 8px rgba(0,0,0,.15);margin-bottom:20px}.under-construction-banner .icon{font-size:18px;margin-right:8px}.under-construction-banner strong{color:#fff;text-transform:uppercase;letter-spacing:.5px}</style><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","name":"Field-weakening","description":"MPLAB Device Blocks for Simulink - Embedded Code Generation for dsPIC, PIC32, and SAM Microcontrollers","url":"https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink\/examples\/test_output\/fieldweakeningdoc.html","author":{"@type":"Organization","name":"Microchip Technology Inc."},"datePublished":"2025-10-17","dateModified":"2025-10-18","inLanguage":"en-US"}</script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},options:{enableMenu:!1,renderActions:{addMenu:[]}}}</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js async></script></head><body><div class=doc-wrapper><nav class=sidebar><div class=sidebar-header><h2 class=sidebar-title>MPLAB Blockset</h2></div><div class=sidebar-nav><div class=nav-section><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/index.html class=nav-section-title style="display:block;border-left:3px solid transparent"><span><span class=icon>üè†</span>Home</span></a></div><div class=nav-section id=section-getting-started><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/index.html class=nav-section-title onclick='return event.stopPropagation(),toggleSection("getting-started"),!0'><span><span class=icon>üöÄ</span>Getting Started</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("getting-started"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/overview.html class=nav-link>Overview</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/installation.html class=nav-link>Installation</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/quick_start.html class=nav-link>Quick Start Guide</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/board_templates.html class=nav-link>Board Templates</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/motor_control_examples.html class=nav-link>Motor Control Examples</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/scheduler_multitasking.html class=nav-link>Scheduler & Multitasking</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/external_mode_pil.html class=nav-link>External Mode & PIL</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/data_visualization.html class=nav-link>Data Visualization</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/getting_started/supported_devices.html class=nav-link>Supported Devices</a></div></div><div class=nav-section id=section-user-guide><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/user_guide/index.html class=nav-section-title onclick='return event.stopPropagation(),toggleSection("user-guide"),!0'><span><span class=icon>üìö</span>User Guide</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("user-guide"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/user_guide/code_generation.html class=nav-link>Code Generation</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/user_guide/compiler_setup.html class=nav-link>Compiler Setup</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/user_guide/external_mode.html class=nav-link>External Mode</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/user_guide/pil_testing.html class=nav-link>PIL Testing</a></div></div><div class=nav-section id=section-block-reference><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/index.html class=nav-section-title onclick='return event.stopPropagation(),toggleSection("block-reference"),!0'><span><span class=icon>üß©</span>Block Reference</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("block-reference"),!1'>‚ñ∂</span></a><div class=nav-section-children><div class=nav-subsection id=section-pwm><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("pwm"),!0'><span><span class=icon>‚ö°</span>PWM</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("pwm"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/pwm.html class=nav-block-link>PWM</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/pwm_highspeed.html class=nav-block-link>PWM High-Speed</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/pwm_hs_fep.html class=nav-block-link>PWM HS FEP</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/pwm_highspeed_override.html class=nav-block-link>PWM HS Override</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/mcpwm.html class=nav-block-link>MCPWM (PIC32)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/pwm_sam7x.html class=nav-block-link>PWM SAM7x</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/pwm_sam7x_override.html class=nav-block-link>PWM SAM7x Override</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/pwm_io/tcc_pwm.html class=nav-block-link>TCC PWM (SAM)</a></div></div><div class=nav-subsection id=section-timers><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/timers/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("timers"),!0'><span><span class=icon>‚è±Ô∏è</span>Timers</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("timers"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/timers/timer_config.html class=nav-block-link>Timer Config</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/timers/timer_pil_profiling.html class=nav-block-link>PIL Profiling Timer</a></div></div><div class=nav-subsection id=section-capture-compare><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/capture_compare/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("capture-compare"),!0'><span><span class=icon>üìè</span>Input Capture / Output Compare</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("capture-compare"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/capture_compare/input_capture.html class=nav-block-link>Input Capture</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/capture_compare/output_compare_hw.html class=nav-block-link>Output Compare (HW)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/capture_compare/output_compare_sw.html class=nav-block-link>Output Compare (SW)</a></div></div><div class=nav-subsection id=section-adc><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("adc"),!0'><span><span class=icon>üìä</span>ADC</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("adc"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/adc.html class=nav-block-link>ADC (dsPIC)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/adc_hs_12b.html class=nav-block-link>ADC HS 12-bit</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/adc_highspeed_sar.html class=nav-block-link>ADC High-Speed SAR</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/adc_highspeed_sar_dspic.html class=nav-block-link>ADC HS SAR (dsPIC)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/adc_same5x.html class=nav-block-link>ADC (SAM E5x)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/adc_samrh707x.html class=nav-block-link>ADC (SAMRH707x)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/adc/afec_sam7x.html class=nav-block-link>AFEC (SAM7x)</a></div></div><div class=nav-subsection id=section-communication><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("communication"),!0'><span><span class=icon>üì°</span>Communication</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("communication"),!1'>‚ñ∂</span></a><div class=nav-section-children><div class=nav-subsection id=section-uart><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication.html#uart-blocks class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("uart"),!0'><span><span class=icon></span>UART</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("uart"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/uart/uart_config.html class=nav-block-link>UART Config</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/uart/uart_tx.html class=nav-block-link>UART Tx</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/uart/uart_rx.html class=nav-block-link>UART Rx</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/uart/uart_txmatlab.html class=nav-block-link>UART Tx MATLAB</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/uart/uart_break_and_autobaud.html class=nav-block-link>UART Break & Autobaud</a></div></div><div class=nav-subsection id=section-can><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication.html#can-blocks class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("can"),!0'><span><span class=icon></span>CAN</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("can"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/can/can_config.html class=nav-block-link>CAN Config</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/can/can_tx.html class=nav-block-link>CAN Tx</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/can/can_rx.html class=nav-block-link>CAN Rx</a></div></div><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/i2c.html class=nav-block-link>I2C Master/Slave</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/communication/spi.html class=nav-block-link>SPI Master/Slave</a></div></div><div class=nav-subsection id=section-digital-io><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/digital_io/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("digital-io"),!0'><span><span class=icon>üîå</span>Digital I/O</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("digital-io"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/digital_io/digital_input.html class=nav-block-link>Digital Input</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/digital_io/digital_output.html class=nav-block-link>Digital Output</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/digital_io/digital_output_read.html class=nav-block-link>Digital Output Read</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/digital_io/digital_output_write.html class=nav-block-link>Digital Output Write</a></div></div><div class=nav-subsection id=section-encoders><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/encoders/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("encoders"),!0'><span><span class=icon>üîÑ</span>Encoders</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("encoders"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/encoders_counters/qei.html class=nav-block-link>QEI (Quadrature Encoder)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/encoders_counters/pdec.html class=nav-block-link>PDEC (SAM)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/encoders_counters/qdec_samx.html class=nav-block-link>QDEC (SAM)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/encoders_counters/change_notification.html class=nav-block-link>Change Notification</a></div></div><div class=nav-subsection id=section-analog-io><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/analog_io/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("analog-io"),!0'><span><span class=icon>üìâ</span>Analog I/O</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("analog-io"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/analog_io/dac_samx.html class=nav-block-link>DAC (SAM)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/analog_io/comparator_opamps_volt_ref/highspeed_analogcomparator.html class=nav-block-link>High-Speed Comparator</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/analog_io/comparator_opamps_volt_ref/highspeed_analogcomparator_wslope.html class=nav-block-link>Comparator w/ Slope</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/analog_io/comparator_opamps_volt_ref/op_amp.html class=nav-block-link>Op-Amp</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/analog_io/comparator_opamps_volt_ref/pga.html class=nav-block-link>PGA (Programmable Gain Amp)</a></div></div><div class=nav-subsection id=section-system-config><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("system-config"),!0'><span><span class=icon>‚öôÔ∏è</span>System Config</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("system-config"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/master.html class=nav-block-link>Master</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/interrupt.html class=nav-block-link>Interrupt</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/compiler_options.html class=nav-block-link>Compiler Options</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/scheduler_options.html class=nav-block-link>Scheduler Options</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/idle_task.html class=nav-block-link>Idle Task</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/mcu_load.html class=nav-block-link>MCU Load</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/mcu_overload.html class=nav-block-link>MCU Overload</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/tasks_state.html class=nav-block-link>Tasks State</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/system_configuration/secondary_core.html class=nav-block-link>Secondary Core</a></div></div><div class=nav-subsection id=section-utility><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/utility/index.html class=nav-subsection-title onclick='return event.stopPropagation(),toggleSection("utility"),!0'><span><span class=icon>üîß</span>Utility Blocks</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("utility"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/user_functions/c_function_call.html class=nav-block-link>C Function Call</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/utility/doc.html class=nav-block-link>Documentation Block</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/utility/msi.html class=nav-block-link>MSI (Model Sample Info)</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/utility/port_info.html class=nav-block-link>Port Info</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/utility/timer_info.html class=nav-block-link>Timer Info</a>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/block_reference/utility/simulink_reset_config.html class=nav-block-link>Simulink Reset Config</a></div></div></div></div><div class=nav-section id=section-examples><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/examples/index.html class=nav-section-title onclick='return event.stopPropagation(),toggleSection("examples"),!0'><span><span class=icon>üìñ</span>Examples</span>
<span class=toggle-icon onclick='return event.preventDefault(),event.stopPropagation(),toggleSection("examples"),!1'>‚ñ∂</span></a><div class=nav-section-children><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/examples/field_weakening.html class=nav-link>Field Weakening</a></div></div><div class=nav-section id=section-github><a href=https://github.com/microchip-technology/mplab-blocksetindex.html class=nav-section-title style="display:block;border-left:3px solid transparent"><span><span class=icon>üíª</span>GitHub</span></a></div></div></nav><div class=content-wrapper><div class=container><div class=breadcrumbs><a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/index.html>Home</a>
<span>></span>
<a href=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/examples/index.html>Examples</a>
<span>></span>
<span>Field-weakening</span></div><div class=page-header><h1>Field-weakening</h1><div class=page-header-right><img src=https://mplab-blockset.github.io/MPLAB-Device-Blocks-for-Simulink/images/microchip-logo.png alt="Microchip Logo" class=microchip-logo>
<button class=theme-toggle onclick=toggleTheme() aria-label="Toggle dark mode">
<span class=theme-icon id=theme-icon>‚òÄÔ∏è</span>
<span id=theme-text>Light</span></button></div></div><p><img src=images/fieldWeakeningDoc_1.png alt=PMSM_FW.png style=max-width:100%;height:auto></p><h2 id=introduction>Introduction</h2><p>This section describes some of the work obtained as part of Hiba Houmsi‚Äôs thesis work, in collaboration with Federico Bribiesca Argomedo, Paolo Massioni and Romain Delpoux. These results have been published in (Houmsi2023). As metionned in the saturation management page, voltage and currents may not exceed positive values $V_{\rm max}$ and $I_{\rm max}$, implying the following inequalities:</p><ul><li><p>$||v_ {dq}|| = \sqrt{v_d^2+v_q^2}\leq V_{\rm max}$ and</p></li><li><p>$||i_ {dq}|| = \sqrt{i_d^2+i_q^2}\leq I_{\rm max}$.</p></li></ul><p>At steady state, the electrical equation of the motor leads to:</p><p>$v_{dq}=Ri_{dq}+p\omega\mathcal{J} Li_{dq}+p\omega \pmatrix{0 \cr \phi_f}$,</p><p>so the saturation constraints is:</p><p>$$
\begin{array}{rl}||i_ {dq}|| \leq & I_{\rm max} \ \left|\left|p\omega \pmatrix{0 \cr phi_f}+(R+p\omega\mathcal{J} )i_{dq}\right|\right| \leq & V_{\rm max}. \end{array}
$$</p><p>Note that the voltage constraint will not allow maximum current to be reached at high speed:</p><p><img src=images/fieldWeakeningDoc_2.png alt=saturationCurrVolt.png style=max-width:100%;height:auto></p><p>While the current i_q is set by the motor torque to be supplied:</p><p>$\tau_m=\frac{3}{2}p\phi_fi_q$,</p><p>the i_d current can be controlled to stay within the voltages limits while reaching higher speeds at a given torque. This is called field-weakening. The strategy proposed here is the implementation of the solution proposed in <strong>(Houmsi2023)</strong> on an embedded industrial target using RCP. This strategy has been the subject of numerous research studies, for example <strong>(Lu2010, Verl1998, Zordan2000)</strong>.</p><h2 id=formulation-of-the-optimisation-problem>Formulation of the optimisation problem</h2><p>The desired behavior is the minimum steady state currents i_{dq} to reach a given speed \omega at a specific load torque \tau under voltage and current constraints. The mathematical formulation is given by:</p><p>$$
\begin{array}{l}
\min_{i_d, i_q}\quad {i_d^2 + i_q^2,}\
\text{s.t}\
\begin{array}{ccl}L\frac{di_{dq}}{dt}&=&amp;v_{dq}-Ri_{dq}-p\omega L\mathcal{J} i_{dq}-e_{dq}=0\
\Vert i_{dq} \Vert^2&=&amp;i_d^2 +i_q^2 \leq I_{max}^2\
\Vert v_{dq} \Vert^2&=&amp;v_d^2 +v_q^2 \leq V_{max}^2\
{i_q}&=&\frac{2}{3}\frac{\tau}{p\phi_f}.
\end{array}
\end{array}
$$</p><p>Substituting the second equation into the forth, we reformulate the voltage constraint into the dq current frame, the optimization problem becomes:</p><p>$$
\begin{array}{l}
\min_{i_d, i_q}\quad {i_d^2 + i_q^2,}\
\text{s.t}\
\begin{array}{rcl}
i_d^2 +i_q^2 &\leq& I_{max}^2\
(i_d+a(\omega))^2 +(i_q+b(\omega))^2 &\leq & c(\omega)\
i_q &=& \frac{2}{3} \frac{\tau}{p\phi_f}.
\end{array}
\end{array}
$$</p><p>We define \Gamma = {\omega,\tau, V_{max}, I_{max}}, the parameters set, and</p><p>$$
\begin{cases}
K(\omega)= \frac{ p\omega\phi_f }{R^2+(p \omega L)^2}, \
a(\omega) = K(\omega)p\omega L, \
b(\omega) = K(\omega)R,\
c(\omega) = \frac{V_{max}^2}{R^2+(pL\omega)^2}. \
\end{cases}
$$</p><p>The optimization problem may be solved using a general Lagrange function including the inequality constraints and the Karush-Kuhn-Tucker (KKT) optimality conditions. The computation of the optimal solutions are not detailled here but can be found in <strong>(Houmsi2023)</strong>.</p><h2 id=kkt-field-weakening-algorithm>KKT Field-Weakening algorithm</h2><p>Define</p><ul><li>$$
\begin{array}{l}
\kappa_1(\omega) = \frac{-a(\omega)^2-b(\omega)^2+c(\omega)-I_{\rm max}^2}{2a(\omega)}\
\kappa_2(\omega) = -\frac{b(\omega)}{a(\omega)}\
\Delta(\omega) = 4\left(I_{\rm max}^2\left(\kappa_2(\omega)^2+1\right)-\kappa_1(\omega)^2\right);\
\end{array}
$$</li></ul><p>and</p><ul><li>$$
\begin{array}{l}
i_1(\omega) = \sqrt{c(\omega)-a(\omega)^2}-b(\omega)\
i_2(\omega) = -\frac{2\kappa_1(\omega)\kappa_2(\omega)+\sqrt{\Delta(\omega)}}{2\left(\kappa_2(\omega)^2+1\right)}\
i_4(\omega) = \sqrt{c(\omega)}-b(\omega);\
i^# = \frac{2}{3}\frac{\tau_m^#}{p\phi_f};
\end{array}
$$</li></ul><p><strong>Algorithm</strong></p><p>Inputs : $( \tau_m,\omega,V_{\rm max},I_{\rm max})\in\Gamma$</p><p>Output: $(I_d^# , I_q^#) \in \Gamma$</p><p>$$
if (i^# &lt;i_1(\omega) || i_1(\omega)\geq I_{\max})
$$</p><p>$$
\ldots\ldots.i_d^# = 0;
$$</p><p>$$
\ldots\ldots.i_q^# = i^#;
$$</p><p>$$
else
$$</p><p>$$
\ldots\ldots.if\left(i_1(\omega)&lt;i_2(\omega) <del>&</del> !\left(i_2(w)^2+\left(-\sqrt{c(w)-\left(i_2(w)+b(w)\right)^2}-a(w)x\right)^2 &lt;= I_{\rm max}^2\right) <del>&</del> \Delta(\omega)>0\right);
$$</p><p>$$
\ldots\ldots\ldots\ldots..i_{\rm sat}=\min(i_2(\omega),I_{\rm max});
$$</p><p>$$
\ldots\ldots.else
$$</p><p>$$
\ldots\ldots\ldots\ldots..i_{\rm sat}=\min(i_4(\omega),I_{\rm max});
$$</p><p>$$
\ldots\ldots.end
$$</p><p>$$
\ldots\ldots.if\left(i^#>\min(i_{\rm sat},I_{\rm max})\right)
$$</p><p>$$
\ldots\ldots\ldots\ldots..i^# = \min(i_{\rm sat},I_{\rm max});
$$</p><p>$$
\ldots\ldots.end
$$</p><p>$$
\ldots\ldots.i_d^# = \sqrt{c(\omega)-(i^#+b(\omega)^2}-a(\omega);
$$</p><p>$$
\ldots\ldots.i_q^# = i^#;
$$</p><p>$$
end
$$</p><p><strong>Example</strong></p><p>To illustrate the field weakening algorithm offline, a Matlab LiveScript <a href="matlab:open('./fieldWeakeningLiveScript.mlx')">fieldWeakeningLiveScript.mlx</a> is proposed also available on <a href=https://github.com/rdelpoux/ctrl-elec/blob/main/MCU/fieldWeakening/fieldWeakeningLiveScript.mlx>GitHub</a>.</p><p>The example compute the field weakening solution for the TI motor with paramerters :</p><ul><li><p>$$
R = 0.656\Omega
$$</p></li><li><p>$$
L = 0.35mH
$$</p></li><li><p>$$
\phi_f = 6.6mWb
$$</p></li><li><p>$$
p = 4
$$</p></li><li><p>$$
\omega_{\rm Max} = 700rad/s;
$$</p></li><li><p>$$
v_{\rm Max} = 12V
$$</p></li><li><p>$$
i_{\rm Max} = 10A
$$</p></li></ul><p>In this example, is imopsed an electromechnical torque of $\tau_m = 0.1 Nm$ corresponding to $i^#=2.53 A$. For this motor, the base speed $\omega_{\rm base}$, defined the higher speed possible at maximum torque without any id current $\omega_{\rm base} = 194.236 rad/s$. After this speed, the field weakening maybe necessary according to the load torque required.</p><p>In the animation below, five cases are shown in succession:</p><ul><li><p>The desired speed is $\omega = 100rad/s$ so that field weakening is not necessary.</p></li><li><p>With $\omega = \omega_{\rm base} = 194.236 rad/s$, the voltage limit cross the current limit for $i_d=0A$. It corresponds to the maximum speed without field weakening whatever the load.</p></li><li><p>$\omega = 380rad/s$, corresponds to the reference speed, under a load of 0.1Nm for which field weakening is not required.</p></li><li><p>Reaching $\omega = 450rad/s$, without field weakening. So we impose a n√©gative current $i_d$</p></li><li><p>$\omega = 600 rad/s$, cannot be reach under a load of 0.1Nm so the algorithm reduces the desired load.</p></li></ul><p>An example for the real time implementation can be download and tested by following the intruction on <a href=https://github.com/rdelpoux/ctrl-elec/tree/main/MCU/fieldWeakening>GitHub</a>* *</p><h2 id=references>References</h2><p>(Houmsi2023) H. Houmsi, F. B. Argomedo, P. Massioni and R. Delpoux, ‚ÄúA Karush-Kuhn-Tucker approach to field-weakening for Surface-Mounted Permanent Magnets Synchronous Motors,‚Äù <em>2023 International Conference on Control, Automation and Diagnosis (ICCAD)</em>, Rome, Italy, 2023, pp. 1-6, <a href=https://ec-lyon.hal.science/hal-04069379/>doi.org/10.1109/ICCAD57653.2023.10152453</a>.</p><p><strong>(Lu2010)</strong> Lu, D., & Kar, N.-C. (2010). A review of flux-weakening control in permanent magnet synchronous machines. <em>IEEE Vehicle Power and Propulsion Conference</em>, 1‚Äì6. <a href=https://doi.org/10.1109/VPPC.2010.5728986>doi.org/10.1109/VPPC.2010.5728986</a></p><p><strong>(Verl1998)</strong> Verl, A., & Bodson, M. (1998). Torque Maximization for Permanent Magnet Synchronous Motors. <em>IEEE Transactions on Control Systems Technology</em>, <em>6</em>(6), 740‚Äì745.</p><p><strong>(Zordan2000)</strong> Zordan, M., Vas, P., Rashed, M., Bolognani, S., & Zigliotto, M. (2000). Field-weakening in high-performance PMSM drives: a comparative analysis. <em>IEEE Industry Applications Conference.</em>, <em>3</em>, 1718‚Äì1724 vol.3. <a href=https://doi.org/10.1109/IAS.2000.882112>doi.org/10.1109/IAS.2000.882112</a></p><div class=nav-footer><p>Last updated: November 2025 | MPLAB Blockset Documentation v3.63a</p><p>&copy; 2025 Microchip Technology Incorporated and its subsidiaries</p><p style=font-size:10px;margin-top:8px;line-height:1.4>The "Microchip" name and logo, the "M" logo, and other names, logos, and brands are registered
and unregistered trademarks of Microchip Technology Incorporated or its affiliates and/or
subsidiaries in the United States and/or other countries ("Microchip Trademarks"). Information
regarding Microchip Trademarks can be found at
<a href=https://www.microchip.com/en-us/about/legal-information/microchip-trademarks target=_blank style=color:var(--accent-primary)>https://www.microchip.com/en-us/about/legal-information/microchip-trademarks</a>.</p></div></div></div><button class=mobile-nav-toggle onclick=toggleMobileSidebar() aria-label="Toggle navigation">
‚ò∞</button></div><script>function toggleTheme(){const t=document.documentElement,n=t.getAttribute("data-theme"),e=n==="dark"?"light":"dark";t.setAttribute("data-theme",e),localStorage.setItem("theme",e),updateThemeButton(e)}function updateThemeButton(e){const t=document.getElementById("theme-icon"),n=document.getElementById("theme-text");e==="dark"?(t.textContent="üåô",n.textContent="Dark"):(t.textContent="‚òÄÔ∏è",n.textContent="Light")}(function(){const n=localStorage.getItem("theme"),s=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=n||(s?"dark":"light");document.documentElement.setAttribute("data-theme",t),updateThemeButton(t)})(),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{if(!localStorage.getItem("theme")){const t=e.matches?"dark":"light";document.documentElement.setAttribute("data-theme",t),updateThemeButton(t)}}),window.toggleSection=function(e){const t=document.getElementById("section-"+e);if(t&&(t.classList.toggle("expanded"),t.classList.contains("nav-section"))){const n=getExpandedSections();t.classList.contains("expanded")?n.add(e):n.delete(e),localStorage.setItem("expandedSections",JSON.stringify([...n]))}};function getExpandedSections(){const e=localStorage.getItem("expandedSections");return new Set(e?JSON.parse(e):[])}function restoreExpandedSections(){const e=getExpandedSections();e.forEach(e=>{const t=document.getElementById("section-"+e);t&&t.classList.add("expanded")})}function highlightActivePage(){const e=window.location.pathname,t=document.querySelectorAll(".nav-link, .nav-block-link, .nav-section-title[href], .nav-subsection-title[href]");t.forEach(t=>{const n=new URL(t.href,window.location.origin).pathname;if(n===e){t.classList.add("active");const n=t.closest(".nav-subsection");n&&!n.classList.contains("expanded")&&n.classList.add("expanded");const e=t.closest(".nav-section");if(e&&!e.classList.contains("expanded")){e.classList.add("expanded");const n=e.id.replace("section-",""),t=getExpandedSections();t.add(n),localStorage.setItem("expandedSections",JSON.stringify([...t]))}}})}window.toggleMobileSidebar=function(){const e=document.querySelector(".sidebar");e&&e.classList.toggle("mobile-visible")},function(){restoreExpandedSections(),highlightActivePage();const t=document.querySelector(".nav-link.active");if(t){const e=t.closest(".nav-section");if(e&&e.id){const n=e.id.replace("section-",""),t=getExpandedSections();t.has(n)||(t.add(n),localStorage.setItem("expandedSections",JSON.stringify([...t])))}}}()</script></body></html>